<?xml version="1.0" encoding="utf-8"?>
<Elements xmlns="http://schemas.microsoft.com/sharepoint/">
	<CustomAction
		Id="Extract.Ribbon.IdShieldTabExample"
		Location="CommandUI.Ribbon.ListView"
		RegistrationType="List"
		RegistrationId="101"
		GroupId="LibraryContextualGroup"
		Sequence="401"
		>

		<CommandUIExtension>
			<CommandUIDefinitions>
				<CommandUIDefinition Location="Ribbon.LibraryContextualGroup._children">
					<Tab Id="Extract.Ribbon.IdShieldTab"
						 Title="ID Shield"
						 Description="ID Shield Controls"
						 Sequence="301"
						 >
						<Scaling Id="Extract.Ribbon.IdShieldTab.Scaling">
							<MaxSize Id="Extract.Ribbon.IdShieldTab.IdShieldOfficeGroup.MaxSize"
									 GroupId="Extract.Ribbon.IdShieldTab.Groups.IdShieldOfficeGroup"
									 Size="TwoLarge"
							/>
							<MaxSize Id="Extract.Ribbon.IdShieldTab.IdShieldSettingsGroup.MaxSize"
									 GroupId="Extract.Ribbon.IdShieldTab.Groups.IdShieldSettingsGroup"
									 Size="ThreeLarge"
							/>
							<Scale Id="Extract.Ribbon.IdShieldTab.IdShieldOfficeGroup.Scaling.IdShieldTabScaling"
								   GroupId="Extract.Ribbon.IdShieldTab.Groups.IdShieldOfficeGroup"
								   Size="TwoLarge"
							/>
							<Scale Id="Extract.Ribbon.IdShieldTab.IdShieldSettingsGroup.Scaling.IdShieldTabScaling"
								   GroupId="Extract.Ribbon.IdShieldTab.Groups.IdShieldSettingsGroup"
								   Size="ThreeLarge"
							/>
						</Scaling>
						<Groups
							Id="Extract.Ribbon.IdShieldTab.Groups"
						>
							<Group
								Id="Extract.Ribbon.IdShieldTab.Groups.IdShieldOfficeGroup"
								Description="Launches ID Shield Office"
								Title="Process now"
								Sequence="52"
								Template="Ribbon.Templates.TwoLargeExample"
							>
								<Controls
									Id="Extract.Ribbon.IdShieldTab.Groups.IdShieldOfficeGroup.Controls"
								>
									<Button
										Id="Extract.Ribbon.IdShieldTab.Groups.IdShieldOfficeGroup.IdShieldOfficeButton"
										Command="Extract.Command.LaunchIdShieldOffice"
										Sequence="11"
										Image16by16="/_layouts/images/IdShieldImages/IDSO16x16.gif"
										Image32by32="/_layouts/images/IdShieldImages/IDSO32x32.gif"
										Description="Launches ID Shield Office to redact the current document."
										LabelText="Redact now"
										TemplateAlias="idso1"
									/>
									<Button
										Id="Extract.Ribbon.IdShieldTab.Group.IdShieldOfficeGroup.IdShieldProcessSelectedButton"
										Command="Extract.Command.ProcessSelectedFiles"
										Sequence="11"
										Image16by16="/_layouts/images/IdShieldImages/ProcessSelected16x16.png"
										Image32by32="/_layouts/images/IdShieldImages/ProcessSelected32x32.png"
										Description="Processes the selected files."
										LabelText="Process selected"
										TemplateAlias="idso2"
									/>
								</Controls>
							</Group>
							<Group
								Id="Extract.Ribbon.IdShieldTab.Groups.IdShieldSettingsGroup"
								Description="Configures ID Shield"
								Title="Configure ID Shield"
								Sequence="49"
								Template="Ribbon.Templates.ThreeLargeExample"
							>
								<Controls
									Id="Extract.Ribbon.IdShieldTab.Groups.IdShieldSettingsGroup.Controls"
								>
									<Button
										Id="Extract.Ribbon.IdShieldTab.Groups.IdShieldSettingsGroup.ProcessWithIdShieldButton"
										Command="Extract.Command.ConfigureFolderToWatch"
										Sequence="17"
										Image16by16="/_layouts/images/IdShieldImages/WatchFolder16x16.png"
										Image32by32="/_layouts/images/IdShieldImages/WatchFolder32x32.png"
										Description="Launches the ID Shield configuration dialog for the current folder."
										LabelText="Watch folder"
										TemplateAlias="idsConfig1"
									/>
									<Button
										Id="Extract.Ribbon.IdShieldTab.Groups.IdShieldSettingsGroup.UnprocessWithIdShieldButton"
										Command="Extract.Command.UnconfigureFolderToProcess"
										Sequence="17"
										Image16by16="/_layouts/images/IdShieldImages/UnwatchFolder16x16.png"
										Image32by32="/_layouts/images/IdShieldImages/UnwatchFolder32x32.png"
										Description="Removes the configuration to watch this folder with ID Shield."
										LabelText="Unwatch folder"
										TemplateAlias="idsUnconfig1"
									/>
									<Button
										Id="Extract.Ribbon.IdShieldTab.Groups.IdShieldSettingsGroup.IdShieldSettingsButton"
										Command="Extract.Command.ConfigureIdShieldSettings"
										Sequence="17"
										Image16by16="/_layouts/images/IdShieldImages/IdShieldConfiguration16x16.png"
										Image32by32="/_layouts/images/IdShieldImages/IdShieldConfiguration32x32.png"
										Description="Launches the ID Shield configuration for the overall ID Shield process."
										LabelText="Settings"
										TemplateAlias="idsConfig2"
									/>
								</Controls>
							</Group>
						</Groups>
					</Tab>
				</CommandUIDefinition>
				<CommandUIDefinition
					Location="Ribbon.Templates._children"
				>
					<GroupTemplate
						Id="Ribbon.Templates.TwoLargeExample"
					>
						<Layout
							Title="TwoLarge"
							LayoutTitle="TwoLarge"
						>
							<Section
								Alignment="Top"
								Type="OneRow"
							>
								<Row>
									<ControlRef DisplayMode="Large" TemplateAlias="idso1" />
									<ControlRef DisplayMode="Large" TemplateAlias="idso2" />
								</Row>
							</Section>
						</Layout>
					</GroupTemplate>
				</CommandUIDefinition>
				<CommandUIDefinition
					Location="Ribbon.Templates._children"
				>
					<GroupTemplate
						Id="Ribbon.Templates.ThreeLargeExample"
					>
						<Layout
							Title="ThreeLarge"
							LayoutTitle="ThreeLarge"
						>
							<Section
								Alignment="Top"
								Type="OneRow"
							>
								<Row>
									<ControlRef DisplayMode="Large" TemplateAlias="idsConfig1" />
									<ControlRef DisplayMode="Large" TemplateAlias="idsUnconfig1" />
									<ControlRef DisplayMode="Large" TemplateAlias="idsConfig2" />
								</Row>
							</Section>
						</Layout>
					</GroupTemplate>
				</CommandUIDefinition>
			</CommandUIDefinitions>
			<CommandUIHandlers>
				<CommandUIHandler
					Command="Extract.Command.LaunchIdShieldOffice"
					CommandAction=""
					EnabledScript="javascript: singleSelectEnabled();"
				/>
				<CommandUIHandler
					Command="Extract.Command.ProcessSelectedFiles"
					CommandAction=""
					EnabledScript="javascript: atLeastOneSelectEnabled();"
				/>
				<CommandUIHandler
					Command="Extract.Command.ConfigureFolderToWatch"
					CommandAction="javascript: showWatchFolderConfiguration();"
					EnabledScript="javascript: noSelectionEnabled();"
				/>
				<CommandUIHandler
					Command="Extract.Command.UnconfigureFolderToProcess"
					CommandAction="javascript: unwatchFolder();"
					EnabledScript="javascript: noSelectionEnabled();"
				/>
				<CommandUIHandler
					Command="Extract.Command.ConfigureIdShieldSettings"
					CommandAction="javascript: showConfigureIdShield();"
					EnabledScript="javascript: noSelectionEnabled();"
				/>
			</CommandUIHandlers>
		</CommandUIExtension>
	</CustomAction>
	<CustomAction Id="Extract.SharePoint.Command.LoadEnableScripts" Location="ScriptLink"
				  ScriptSrc="/_layouts/Extract.SharePoint/EnableHelpers.js"
	/>
	<CustomAction Id="Extract.SharePoint.Redaction.Command.LoadHelperScripts"
				  Location="ScriptLink"
				  ScriptSrc="/_layouts/Extract.SharePoint.Redaction/RedactionHelpers.js"
	/>
</Elements>
