<?xml version="1.0" encoding="utf-8"?>
<Elements xmlns="http://schemas.microsoft.com/sharepoint/">
	<CustomAction
		Id="Extract.Ribbon.DataCaptureTab"
		Location="CommandUI.Ribbon.ListView"
		RegistrationType="List"
		RegistrationId="101"
		GroupId="LibraryContextualGroup"
		Sequence="501"
		>

		<CommandUIExtension>
			<CommandUIDefinitions>
				<CommandUIDefinition Location="Ribbon.LibraryContextualGroup._children">
					<Tab Id="Extract.Ribbon.DataCaptureTab"
						 Title="Data Capture"
						 Description="Extract Data Capture Controls"
						 Sequence="401"
						 >
						<Scaling Id="Extract.Ribbon.DataCaptureTab.Scaling">
							<MaxSize Id="Extract.Ribbon.DataCaptureTab.DataCaptureSettingsGroup.MaxSize"
									 GroupId="Extract.Ribbon.DataCaptureTab.Groups.DataCaptureSettingsGroup"
									 Size="DataCaptureTwo"
							/>
							<Scale Id="Extract.Ribbon.DataCaptureTab.IdShieldSettingsGroup.Scaling.DataCaptureTabScaling"
								   GroupId="Extract.Ribbon.DataCaptureTab.Groups.DataCaptureSettingsGroup"
								   Size="DataCaptureTwo"
							/>
						</Scaling>
						<Groups
							Id="Extract.Ribbon.DataCaptureTab.Groups"
						>
							<Group
								Id="Extract.Ribbon.DataCaptureTab.Groups.DataCaptureSettingsGroup"
								Description="Configures Extract Data Capture"
								Title="Extract Data Capture"
								Sequence="49"
								Template="Ribbon.Templates.DataCaptureTwo"
							>
								<Controls
									Id="Extract.Ribbon.DataCaptureTab.Groups.DataCaptureSettingsGroup.Controls"
								>
									<Button
										Id="Extract.Ribbon.DataCaptureTab.Groups.DataCaptureSettingsGroup.ProcessFolderButton"
										Command="Extract.DataCapture.Command.ConfigureProcessFolder"
										Sequence="17"
										Image16by16="/_layouts/images/Extract.SharePoint/WatchFolder16x16.png"
										Image32by32="/_layouts/images/Extract.SharePoint/WatchFolder32x32.png"
										Description="Launches the Extract data capture configuration dialog for the current folder."
										LabelText="Process folder"
										TemplateAlias="edcbutton1"
									/>
									<Button
										Id="Extract.Ribbon.DataCaptureTab.Groups.DataCaptureSettingsGroup.UnprocessFolderButton"
										Command="Extract.DataCapture.Command.UnconfigureFolderToProcess"
										Sequence="17"
										Image16by16="/_layouts/images/Extract.SharePoint/UnwatchFolder16x16.png"
										Image32by32="/_layouts/images/Extract.SharePoint/UnwatchFolder32x32.png"
										Description="Removes the Extract data capture configuration for this folder."
										LabelText="Remove settings"
										TemplateAlias="edcbutton2"
									/>
                  <Button
                    Id="Extract.Ribbon.DataCaptureTab.Groups.DataCaptureSettingsGroup.ProcessSelectedButton"
                    Command="Extract.DataCapture.Command.processSelectedForDataCapture"
                    Sequence="17"
                    Image16by16="/_layouts/images/Extract.SharePoint/ProcessSelected16x16.png"
                    Image32by32="/_layouts/images/Extract.SharePoint/ProcessSelected32x32.png"
                    Description="Quest the selected file for processing."
                    LabelText="Process Selected"
                    TemplateAlias="edcbutton3"
									/>
								</Controls>
							</Group>
						</Groups>
					</Tab>
				</CommandUIDefinition>
				<CommandUIDefinition
					Location="Ribbon.Templates._children"
				>
					<GroupTemplate
						Id="Ribbon.Templates.DataCaptureTwo"
					>
						<Layout
							Title="DataCaptureTwo"
							LayoutTitle="DataCaptureTwo"
						>
							<Section
								Alignment="Top"
								Type="OneRow"
							>
								<Row>
									<ControlRef DisplayMode="Large" TemplateAlias="edcbutton1" />
									<ControlRef DisplayMode="Large" TemplateAlias="edcbutton2" />
                  <ControlRef DisplayMode="Large" TemplateAlias="edcbutton3" />
								</Row>
							</Section>
						</Layout>
					</GroupTemplate>
				</CommandUIDefinition>
			</CommandUIDefinitions>
			<CommandUIHandlers>
				<CommandUIHandler
					Command="Extract.DataCapture.Command.ConfigureProcessFolder"
					CommandAction="javascript: showProcessFolderConfiguration();"
					EnabledScript="javascript: noSelectionEnabled();"
				/>
				<CommandUIHandler
					Command="Extract.DataCapture.Command.UnconfigureFolderToProcess"
					CommandAction="javascript: unwatchCaptureFolder();"
					EnabledScript="javascript: noSelectionEnabled();"
				/>
        <CommandUIHandler
          Command="Extract.DataCapture.Command.processSelectedForDataCapture"
          CommandAction="javascript: processSelectedForDataCapture();"
          EnabledScript="javascript: atLeastOneSelectEnabled();"
				/>
			</CommandUIHandlers>
		</CommandUIExtension>
	</CustomAction>
	<CustomAction Id="Extract.SharePoint.Command.LoadEnableScripts" Location="ScriptLink"
				  ScriptSrc="/_layouts/Extract.SharePoint/EnableHelpers.js"
	/>
	<CustomAction Id="Extract.SharePoint.DataCapture.Command.LoadHelperScripts"
				  Location="ScriptLink"
				  ScriptSrc="/_layouts/Extract.SharePoint.DataCapture/DataCaptureHelpers.js"
	/>
</Elements>
