<?xml version="1.0" encoding="utf-8"?>
<Elements xmlns="http://schemas.microsoft.com/sharepoint/">
	<CustomAction
		Id="Extract.Ribbon.IdShieldTab"
		Location="CommandUI.Ribbon.ListView"
		RegistrationType="List"
		RegistrationId="101"
		GroupId="LibraryContextualGroup"
		Sequence="401"
		>

		<CommandUIExtension>
			<CommandUIDefinitions>
				<CommandUIDefinition Location="Ribbon.LibraryContextualGroup._children">
					<Tab Id="Extract.Ribbon.IdShieldTab"
						 Title="ID Shield"
						 Description="ID Shield Controls"
						 Sequence="301"
						 >
						<Scaling Id="Extract.Ribbon.IdShieldTab.Scaling">
							<MaxSize Id="Extract.Ribbon.IdShieldTab.IdShieldOfficeGroup.MaxSize"
									 GroupId="Extract.Ribbon.IdShieldTab.Groups.IdShieldOfficeGroup"
									 Size="OneLarge"
							/>
							<MaxSize Id="Extract.Ribbon.IdShieldTab.IdShieldSettingsGroup.MaxSize"
									 GroupId="Extract.Ribbon.IdShieldTab.Groups.IdShieldSettingsGroup"
									 Size="TwoLarge"
							/>
							<Scale Id="Extract.Ribbon.IdShieldTab.IdShieldOfficeGroup.Scaling.IdShieldTabScaling"
								   GroupId="Extract.Ribbon.IdShieldTab.Groups.IdShieldOfficeGroup"
								   Size="OneLarge"
							/>
							<Scale Id="Extract.Ribbon.IdShieldTab.IdShieldSettingsGroup.Scaling.IdShieldTabScaling"
								   GroupId="Extract.Ribbon.IdShieldTab.Groups.IdShieldSettingsGroup"
								   Size="TwoLarge"
							/>
						</Scaling>
						<Groups
							Id="Extract.Ribbon.IdShieldTab.Groups"
						>
							<Group
								Id="Extract.Ribbon.IdShieldTab.Groups.IdShieldOfficeGroup"
								Description="Launches ID Shield Office"
								Title="Process now"
								Sequence="52"
								Template="Ribbon.Templates.OneLargeExample"
							>
								<Controls
									Id="Extract.Ribbon.IdShieldTab.Groups.IdShieldOfficeGroup.Controls"
								>
									<Button
										Id="Extract.Ribbon.IdShieldTab.Groups.IdShieldOfficeGroup.IdShieldOfficeButton"
										Command="Extract.Redaction.Command.LaunchIdShieldOffice"
										Sequence="11"
										Image16by16="/_layouts/images/Extract.SharePoint.Redaction/IDSO16x16.gif"
										Image32by32="/_layouts/images/Extract.SharePoint.Redaction/IDSO32x32.gif"
										Description="Launches ID Shield Office to redact the current document."
										LabelText="Redact now"
										TemplateAlias="idsbutton1"
									/>
								</Controls>
							</Group>
							<Group
								Id="Extract.Ribbon.IdShieldTab.Groups.IdShieldSettingsGroup"
								Description="Configures ID Shield"
								Title="Configure ID Shield"
								Sequence="49"
								Template="Ribbon.Templates.TwoLargeExample"
							>
								<Controls
									Id="Extract.Ribbon.IdShieldTab.Groups.IdShieldSettingsGroup.Controls"
								>
									<Button
										Id="Extract.Ribbon.IdShieldTab.Groups.IdShieldSettingsGroup.ProcessWithIdShieldButton"
										Command="Extract.Redaction.Command.ConfigureProcessFolder"
										Sequence="17"
										Image16by16="/_layouts/images/Extract.SharePoint/WatchFolder16x16.png"
										Image32by32="/_layouts/images/Extract.SharePoint/WatchFolder32x32.png"
										Description="Launches the ID Shield configuration dialog for the current folder."
										LabelText="Process folder"
										TemplateAlias="idsbutton1"
									/>
									<Button
										Id="Extract.Ribbon.IdShieldTab.Groups.IdShieldSettingsGroup.UnprocessWithIdShieldButton"
										Command="Extract.Redaction.Command.UnconfigureFolderToProcess"
										Sequence="17"
										Image16by16="/_layouts/images/Extract.SharePoint/UnwatchFolder16x16.png"
										Image32by32="/_layouts/images/Extract.SharePoint/UnwatchFolder32x32.png"
										Description="Removes the ID Shield configuration for this folder."
										LabelText="Remove settings"
										TemplateAlias="idsbutton2"
									/>
                  <Button
                    Id="Extract.Ribbon.IdShieldTab.Groups.IdShieldSettingsGroup.ProcessSelectedButton"
                    Command="Extract.Redaction.Command.ProcessSelectedForRedaction"
                    Sequence="17"
                    Image16by16="/_layouts/images/Extract.SharePoint/ProcessSelected16x16.png"
                    Image32by32="/_layouts/images/Extract.SharePoint/ProcessSelected32x32.png"
                    Description="Quest the selected file for processing."
                    LabelText="Process Selected"
                    TemplateAlias="idsbutton3"
									/>
                  <Button
										Id="Extract.Ribbon.IdShieldTab.Groups.IdShieldSettingsGroup.VerifyNowButton"
										Command="Extract.Redaction.Command.LaunchVerification"
										Sequence="17"
										Image16by16="/_layouts/images/Extract.SharePoint/Verify16x16.png"
										Image32by32="/_layouts/images/Extract.SharePoint/Verify32x32.png"
										Description="Opens verification window for selected document."
										LabelText="Verify"
										TemplateAlias="idsbutton4"
									/>
                </Controls>
							</Group>
						</Groups>
					</Tab>
				</CommandUIDefinition>
				<CommandUIDefinition
					Location="Ribbon.Templates._children"
				>
					<GroupTemplate
						Id="Ribbon.Templates.TwoLargeExample"
					>
						<Layout
							Title="TwoLarge"
							LayoutTitle="TwoLarge"
						>
							<Section
								Alignment="Top"
								Type="OneRow"
							>
								<Row>
									<ControlRef DisplayMode="Large" TemplateAlias="idsbutton1" />
									<ControlRef DisplayMode="Large" TemplateAlias="idsbutton2" />
                  <ControlRef DisplayMode="Large" TemplateAlias="idsbutton3" />
                  <ControlRef DisplayMode="Large" TemplateAlias="idsbutton4" />
                </Row>
							</Section>
						</Layout>
					</GroupTemplate>
				</CommandUIDefinition>
				<CommandUIDefinition
					Location="Ribbon.Templates._children"
				>
					<GroupTemplate
						Id="Ribbon.Templates.OneLargeExample"
					>
						<Layout
							Title="OneLarge"
							LayoutTitle="OneLarge"
						>
							<Section
								Alignment="Top"
								Type="OneRow"
							>
								<Row>
									<ControlRef DisplayMode="Large" TemplateAlias="idsbutton1" />
								</Row>
							</Section>
						</Layout>
					</GroupTemplate>
				</CommandUIDefinition>
			</CommandUIDefinitions>
			<CommandUIHandlers>
				<CommandUIHandler
					Command="Extract.Redaction.Command.LaunchIdShieldOffice"
					CommandAction="javascript: showRedactNowHelper();"
					EnabledScript="javascript: singleDocSelectEnabled();"
				/>
				<CommandUIHandler
					Command="Extract.Redaction.Command.ConfigureProcessFolder"
					CommandAction="javascript: showWatchFolderConfiguration();"
					EnabledScript="javascript: noSelectionEnabled();"
				/>
				<CommandUIHandler
					Command="Extract.Redaction.Command.UnconfigureFolderToProcess"
					CommandAction="javascript: unwatchFolder();"
					EnabledScript="javascript: noSelectionEnabled();"
				/>
        <CommandUIHandler
          Command="Extract.Redaction.Command.ProcessSelectedForRedaction"
          CommandAction="javascript: ProcessSelectedForRedaction()"
          EnabledScript="javascript: atLeastOneDocSelectEnabled();"
				/>
        <CommandUIHandler
					Command="Extract.Redaction.Command.LaunchVerification"
					CommandAction="javascript: showVerifyNowHelper();"
					EnabledScript="javascript: singleDocSelectEnabled();"
				/>			
      </CommandUIHandlers>
		</CommandUIExtension>
	</CustomAction>
	<CustomAction Id="Extract.SharePoint.Command.LoadEnableScripts" Location="ScriptLink"
				  ScriptSrc="/_layouts/Extract.SharePoint/EnableHelpers.js"
	/>
	<CustomAction Id="Extract.SharePoint.Redaction.Command.LoadHelperScripts"
				  Location="ScriptLink"
				  ScriptSrc="/_layouts/Extract.SharePoint.Redaction/RedactionHelpers.js"
	/>
</Elements>
