<html>
<head>
<TITLE>FAM Service Testing Checklist</TITLE>
<link type="text/css" rel="stylesheet" href="../../../../../ReusableComponents/COMComponents/UCLIDTestingFramework/Misc/UCLIDTesting.css">
</head>
<body>

<h1>Running File Action Manager as a Service<br>
<IMG src="../../../../../ReusableComponents/COMComponents/UCLIDTestingFramework/Misc/TestingChecklistHeader.gif">
</h1>	
<hr>
<p>
The following tests requires two or more machines. See associated instructions for preparing machines 
for use with <b>SQL Server 2005</b> or <b>SQL Server 2008</b>.  The machines that run the service are 
called the <b>service machine</b>.  The machine that contains the database is referred to as the 
<b>database machine</b>.
<p>
<ul>
	<li><b>Rules, Images, and FPS files</b>
	<ul>
		<li><b>FLEX Index</b>
		<ul>
			<li>Make a local copy of <b>CT - Manchester - Cott</b> TIF images from 
			Set002.
			<li>Make a local copy of the most recent <b>CT - Manchester - Cott</b> 
			Indexing rules delivery.
<p>
			<li>Create a <b>Queuing</b> FPS file to supply the images for processing.  
			Use a UNC path for the Folder file supplier.
			<li>Create a <b>Listening</b> FPS file to supply existing images for processing.  
			Also define a second supplier to listen to a folder. Use UNC paths for 
			the Folder file suppliers.
			<li>Create a <b>Processing</b> FPS file to process the images.  Use a 
			<b>Core: Execute rules</b> task.
<p>
			<li>Use the <b>SQL CE Editor</b> to add the FPS files to the 
			<b>ESFAMService.sdf</b> database.  The database is created during 
			installation and is located in a <b>Service</b> folder parallel to the 
			<b>LogFiles</b> folder used for exception logs.
			<li>Activate the FPS files appropriate for the test to be executed.
		</ul>
		<li><b>ID Shield</b>
		<ul>
			<li>Make a local copy of <b>IL - Lake - Cott</b> TIF images from 
			Set002.
			<li>Make a local copy of the most recent <b>IL - Lake - Cott</b> 
			Redaction rules delivery.
<p>
			<li>Create a <b>Queuing</b> FPS file to supply the images for processing.  
			Use a UNC path for the Folder file supplier.
			<li>Create a <b>Listening</b> FPS file to supply existing images for 
			processing.  Also define a second supplier to listen to a folder. Use UNC 
			paths for the Folder file suppliers.
			<li>Create a <b>Processing</b> FPS file to process the images.  Use a 
			<b>Core: Execute rules</b> task and a <b>Redaction: Create redacted 
			image</b> task.
<p>
			<li>Use the <b>SQL CE Editor</b> to add the FPS files to the 
			<b>ESFAMService.sdf</b> database.  The database is created during 
			installation and is located in a <b>Service</b> folder parallel to the 
			<b>LogFiles</b> folder used for exception logs.
			<li>Activate the FPS files appropriate for the test to be executed.
		</ul>
	</ul>
	</li>
<p>
	<li><b>FLEX Index Basic: Local system user, single machine</b>
	<ul>
		<li>Confirm on the database machine that the database is clear.
		<li>Set the FLEX Index <b>Queuing</b> and <b>Processing</b> FPS files to AutoStart.
		<li>Set the service startup type to <b>Automatic</b>.
		<li>Restart the <b>service machine</b>.  Do not login.</li>
		<li>Using a different machine, open up a FAM instance connected to 
		the processing database and activate the <b>Statistics</b> tab.</li>
		<li>Confirm that files are queuing and processing.</li>
<p>
		<li>Login to the <b>service machine</b>.</li>
		<li>Confirm via <b>Task Manager</b> that the following instances are active:
		<ul> 
			<li><b>ESFAMProcess.exe</b> - one instance for the service
			<li><b>FAMProcess.exe</b> - one instance for the Queuing FPS file
			<li><b>FAMProcess.exe</b> - one instance for the Processing FPS file
		</ul> 
		<li>Stop the service from the <b>Services</b> management console.
		<li>If queuing has not finished on its own, confirm that it stops 
		immediately.
		<li>Confirm that processing stops gracefully as soon as the currently 
		processing files are finished.
		<ul>
			<li>Confirm that an application trace is logged when the service 
			<b>starts</b>.
			<li>Confirm that an application trace is logged when the service 
			<b>is stopping</b>.
			<li>Confirm that an application trace is logged when the service 
			<b>has stopped</b>.
		</ul>
		<li>Confirm via <b>Task Manager</b> that none of the above EXEs are 
		continuing to run.
		<li>Confirm via <b>DB Admin</b> that no files are left in <b>Processing</b> 
		mode.
	</ul>
	</li>
<p>
	<li><b>ID Shield Basic: Local system user, single machine</b>
	<ul>
		<li>Confirm on the database machine that the database is clear.
		<li>Set the ID Shield <b>Queuing</b> and <b>Processing</b> FPS files to AutoStart.
		<li>Set the service startup type to <b>Delayed</b> or <b>Automatic</b>.
		<li>Restart the <b>service machine</b>.</li>
		<li>Using a different machine, open up a FAM instance connected to 
		the processing database and activate the <b>Statistics</b> tab.</li>
		<li>Confirm that files are queuing and processing.</li>
		<li>Confirm that redacted images are being created.</li>
<p>
		<li>Login to the <b>service machine</b>.</li>
		<li>Confirm via <b>Task Manager</b> that the following instances are active:
		<ul> 
			<li><b>ESFAMProcess.exe</b> - one instance for the service
			<li><b>FAMProcess.exe</b> - one instance for the Queuing FPS file
			<li><b>FAMProcess.exe</b> - one instance for the Processing FPS file
		</ul> 
		<li>Stop the service from the <b>Services</b> management console.
		<li>If queuing has not finished on its own, confirm that it stops 
		immediately.
		<li>Confirm that processing stops gracefully as soon as the currently 
		processing files are finished.
		<li>Confirm via <b>Task Manager</b> that none of the above EXEs are 
		continuing to run.
		<li>Confirm via <b>DB Admin</b> that no files are left in <b>Processing</b> 
		mode.
	</ul>
	</li>
<p>
	<li><b>FLEX Index Complex:</b>
	<ul>
		<li><b>Local system user, listening for supplied files</b>
		<ul>
			<li>Confirm on the database machine that the database is clear.
			<li>Prepare the <b>Queuing</b> FPS file to only supply images via 
			listening to a folder on a different test machine.
			<li>Set the FLEX Index <b>Queuing</b> and <b>Processing</b> FPS files to 
			AutoStart.
			<li>Set the service startup type to <b>Automatic</b>.
			<li>Restart the <b>service machine</b>.  Do not login.</li>
			<li>Using a different machine, open up a FAM instance connected to 
			the processing database and activate the <b>Statistics</b> tab.</li>
			<li>Confirm that files <b>are not</b> queuing and processing.</li>
			<li>Add some files to the remote folder to test the listening feature.
			<li>Confirm that files <b>are</b> queuing and processing.</li>
		</ul>
		<li><b>Domain user, non-UNC path for supplying</b>
		<ul>
			<li>Confirm on the database machine that the database is clear.
			<li>Prepare the service to use login information for a specified 
			domain user.
			<li>Prepare the <b>Queuing</b> FPS file to supply images from a 
			non-UNC path.
			<li>Set the FLEX Index <b>Queuing</b> and <b>Processing</b> FPS files 
			to AutoStart.
			<li>Set the service startup type to <b>Delayed</b> or <b>Automatic</b>.
			<li>Restart the <b>service machine</b>.  Do not login.</li>
			<li>Using a different machine, open up a FAM instance connected to 
			the processing database and activate the <b>Statistics</b> tab.</li>
			<li>Confirm that files are queuing and processing.</li>
		</ul>
	</ul>
	</li>
<p>
	<li><b>ID Shield Complex:</b>
	<ul>
		<li><b>Local system users, two machines</b>
		<ul>
			<li>Confirm on the database machine that the database is clear.
			<li>For each service machine, set the ID Shield <b>Queuing</b> and 
			<b>Processing</b> FPS files to AutoStart.
			<li>Set the service startup types to <b>Delayed</b> or <b>Automatic</b>.
			<li>Restart the <b>service machines</b>.  Do not login.</li>
			<li>Using a different machine, open up a FAM instance connected to 
			the processing database and activate the <b>Statistics</b> tab.</li>
			<li>Confirm that files are queuing and processing.</li>
			<li>Confirm that redacted images are being created.</li>
<p>
			<li>Login to one of the service machines and <b>Stop</b> the 
			<b>ESFAMProcess.exe</b> service.
			<li>Confirm that files are continuing to process.</li>
			<li>Confirm that redacted images are being created.</li>
			<li><b>Start</b> the <b>ESFAMProcess.exe</b> service.
<p>
			<li>Login to the other service machine and <b>Stop</b> the 
			<b>ESFAMProcess.exe</b> service.
			<li>Confirm that files are continuing to process.</li>
			<li>Confirm that redacted images are being created.</li>
		</ul>
		<li><b>Local system user, scheduled processing</b>
		<ul>
			<li>Confirm on the database machine that the database is clear.
			<li>Modify the <b>Processing</b> FPS file to use scheduled processing.  
			Ensure that processing <b>will not</b> be active when the test commences.
			<li>Set the ID Shield <b>Queuing</b> and <b>Processing</b> FPS files to 
			AutoStart.
			<li>Set the service startup type to <b>Delayed</b> or <b>Automatic</b>.
			<li>Restart the <b>service machine</b>.</li>
			<li>Using a different machine, open up a FAM instance connected to 
			the processing database and activate the <b>Statistics</b> tab.</li>
			<li>Confirm that files <b>are</b> queuing.</li>
			<li>Confirm that files <b>are not</b> processing.</li>
			<li>Confirm that redacted images <b>are not</b> being created.</li>
			<li>Wait until the scheduled processing is due to start.
			<li>Confirm that files <b>are</b> processing.</li>
			<li>Confirm that redacted images <b>are</b> being created.</li>
		</ul>
		<li><b>Local system user, stop service during processing of large file</b>
		<ul>
			<li>Confirm on the database machine that the database is clear.
			<li>Provide very large (~100 pages) files for processing.
			<li>Modify the <b>Processing</b> FPS file to use a single thread.
			<li>Set the ID Shield <b>Queuing</b> and <b>Processing</b> FPS files to 
			AutoStart.
			<li>Set the service startup type to <b>Delayed</b> or <b>Automatic</b>.
			<li>Restart the <b>service machine</b>.</li>
			<li>Using a different machine, open up a FAM instance connected to 
			the processing database and activate the <b>Statistics</b> tab.</li>
			<li>Confirm that files are queuing and processing.</li>
			<li>Confirm that redacted images are being created.</li>
<p>
			<li>Login to the service machine and <b>Stop</b> the <b>ESFAMProcess.exe</b> 
			service.
			<li>Confirm that the service continues processing until the large image 
			has finished.
			<li>Confirm that the redacted image is created.</li>
		</ul>
	</ul>
	</li>
<p>
	<li><b>Error Handling:</b>
	<ul>
		<li><b>Run multiple FPS files, then kill some</b>
		<ul>
			<li>Confirm on the database machine that the database is clear.
			<li>Create four or more FPS files configured for AutoStart.
			<li>Set the service startup type to <b>Automatic</b>.
			<li>Restart the <b>service machine</b>.</li>
			<li>Confirm that files are processing.</li>
			<li>From <b>Task Manager</b>, kill two of the running 
			<b>FAMProcess.exe</b> instances.
			<li>Confirm that the remaining <b>FAMProcess.exe</b> instances 
			continue to run.</li>
		</ul>
		<li><b>Stop the service after killing FPS files</b>
		<ul>
			<li>Continuing the above test, <b>Stop</b> the <b>Extract Systems 
			FAM service</b> service from the Services management console.
			<li>Confirm that each running <b>FAMProcess.exe</b> instance 
			finishes processing the active files and then stops gracefully.</li>
			<li><b>[DotNet #358]</b> Confirm that <b>ELI28498</b> exceptions 
			are not seen for each previously killed instance of FAMProcess.exe.
		</ul>
		<li><b>Restart the stopped service</b>
		<ul>
			<li>Continuing the above test, <b>Start</b> the <b>Extract Systems 
			FAM service</b> service from the Services management console.
			<li>Confirm that each of the original four or more FPS files start 
			processing files.</li>
		</ul>
<p>
		<li><b>Longer timeout during restart of machine</b>
		<ul>
			<li>Confirm on the database machine that the database is clear.
			<li>Create one FPS file configured for AutoStart.
			<li>Provide several large (20-30+ pages) images for processing.
			<li>Set the service startup type to <b>Automatic</b>.
			<li>Restart the <b>service machine</b>.</li>
			<li>Confirm that files are processing.</li>
			<li><b>Restart</b> the test machine from the Start menu.
			<li>Confirm that the <b>FAMProcess.exe</b> instance 
			gracefully finishes its processing.</li>
			<li>Confirm that an Application trace message is logged for 
			<b>FAM Service stopping</b>.
			<li>Confirm that an Application trace message is logged for 
			<b>FAM Service stopped</b>.
		</ul>
<p>
		<li><b>[DotNetRC #363] Clear database while processing</b>
		<ul>
			<li>Confirm on the database machine that the database is clear.
			<li>Create one or more FPS files configured for AutoStart.
			<li>Set the service startup type to <b>Automatic</b>.
			<li>Restart the <b>service machine</b>.</li>
			<li>Confirm that files are processing.</li>
			<li><b>Clear</b> the database.
			<li>Confirm that the meaningful errors are logged.</li>
			<li>Confirm that the service can be stopped without additional errors.</li>
		</ul>
<p>
		<li><b>Run multiple FPS files, then gracefully restart the machine</b>
		<ul>
			<li>Confirm on the database machine that the database is clear.
			<li>Create four or more FPS files configured for AutoStart.
			<li>Set the service startup type to <b>Automatic</b>.
			<li>Restart the <b>service machine</b>.</li>
			<li>Confirm that files are processing.</li>
			<li><b>Restart</b> the test machine from the Start menu.
			<li>Confirm that the <b>FAMProcess.exe</b> instances 
			gracefully finish their processing.</li>
			<li>Confirm that files are processing normally after restart.</li>
			<li>Confirm that if files were stuck in <b>Processing</b> mode 
			during the restart, that they automatically revert to 
			<b>Pending</b> mode.</li>
		</ul>
<p>
		<li><b>Run multiple FPS files, then ungracefully restart the machine</b>
		<ul>
			<li>Confirm on the database machine that the database is clear.
			<li>Create four or more FPS files configured for AutoStart.
			<li>Set the service startup type to <b>Automatic</b>.
			<li>Restart the <b>service machine</b>.</li>
			<li>Confirm that files are processing.</li>
			<li><b>Restart</b> the test machine by cycling power.
			<li>Confirm that files are processing normally after restart.</li>
			<li>Confirm that files stuck in <b>Processing</b> mode during the 
			restart automatically revert to <b>Pending</b> mode.</li>
		</ul>
	</ul>
	</li>
<p>
	<li><b>Miscellaneous</b>
	<ul>
  	   	<LI><b>[DotNet #370, #373, #374]</b> FAM service
	       	<ul>
	      		<li>Confirm that <b>ESFAMService.sdf</b> is located in the 
			<b>CommonComponents</b> folder.
	      		<li>Confirm that <b>ESFAMService.sdf</b> contains a <b>Settings</b> table.
			<li>Confirm that the <b>Settings</b> table includes a 
			<b>SleepTimeOnStart</b> field.
			<li>Confirm that the <b>SleepTimeOnStart</b> field defaults to 
			<b>120000</b>.  Units are milliseconds.
			<li>Confirm that the <b>Settings</b> table includes a 
			<b>DependentServices</b> field.
			<li>Confirm that the <b>DependentServices</b> field is empty by default.
<p>
			<li>Exercise the FAM service and confirm that the service does not 
			start until after the <b>SleepTimeOnStart</b> value.
			<li>Add an entry to the <b>DependentServices</b> field.  Confirm that the 
			service is not currently running.
			<li>Confirm that the FAM service does not start if the specified dependent 
			service has not started.
			<li>Confirm that an exception is logged after the sleep time has expired 
			noting which dependent services have not started.
			<li>Start the dependent service.
			<li>Confirm that the FAM service starts.
			<li>Stop the FAM service.
<p>
			<li>Add more entries to the <b>DependentServices</b> field using a pipe 
			character as a delimiter.
			<li>Confirm that the FAM service does not start if only some of the specified 
			dependent services have started.
			<li>Confirm that an exception is logged after the sleep time has expired 
			noting which dependent services have not started.
			<li>Stop the FAM service.
			<li>Confirm that an exception is logged noting which dependent services 
			have still not started as of the stop request.
	       	</ul>
	</ul>
	</li>
</ul>
</body> 
</html>
