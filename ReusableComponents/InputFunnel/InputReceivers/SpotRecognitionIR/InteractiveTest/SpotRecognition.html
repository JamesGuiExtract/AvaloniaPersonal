<html>

<head>
<title>Image Viewer Testing Checklist</TITLE>
<link type="text/css" rel="stylesheet" href="../../../../COMComponents/UCLIDTestingFramework/Misc/UCLIDTesting.css">
</head>

<body>

<h1>Image Viewer Testing Checklist<br>
<IMG src="../../../../../ReusableComponents/COMComponents/UCLIDTestingFramework/Misc/TestingChecklistHeader.gif">
</h1>
<hr>

<h2>NOTE: Additional test cases can be found in the IcoMapESRI/Testing/ITC folder.</h2>

<hr>

<ol>

<!-- *********************************************** -->
<li><h3>Command-line options</h3>
<ul>
   	<li><b>[LegacyRC #5342] /c</b> option - Send OCR text to Clipboard
	<ul>
		<li>Run <b>ImageViewer.exe /c &lt;image_file&gt;</b> from a command window.
		<li>Confirm that the image opens in ImageViewer.exe.
		<li>Use <b>Recognize text and process</b> to select some text for OCR.
		<li>Confirm that the recognized text <b>is not displayed</b> in a message box.
		<li>Confirm that the recognized text <b>is</b> available in the Clipboard.
	</ul>
<p>
   	<li><b>[LegacyRC #3462, #5341] /closeall</b> option - Close all open instances
	<ul>
		<li>Run <b>ImageViewer.exe &lt;image_file_one&gt;</b> from a command window.
		<li>Run <b>ImageViewer.exe &lt;image_file_two&gt;</b> from a command window.
		<li>Confirm that each image is displayed in a separate Image Viewer.
		<li>Run <b>ImageViewer.exe /closeall</b> from a command window.
		<li>Confirm that both open instances are closed.
	</ul>
<p>
   	<li><b>[LegacyRC #5347] /ctrlid?</b> option - Display button IDs
	<ul>
		<li>Run <b>ImageViewer.exe /ctrlid?</b> from a command window.
		<li>Confirm that a message box is displayed with button ID usage information 
		for use during scripting.
	</ul>
<p>
   	<li><b>[LegacyRC #3665] /e</b> option - Script file in usage message
	<ul>
		<li>Run <b>ImageViewer.exe /?</b> from a command window.
		<li>Confirm that the usage statement includes a <b>/e</b> option to specify 
		a script file.
	</ul>
<p>
   	<li><b>[FlexIDSCore #2930] /l</b> option - Reuse current Image Viewer
	<ul>
		<li>Open an image file with the Image Viewer.
		<li>Run <b>ImageViewer.exe /l &lt;second_image&gt;</b> from a command 
		window where <b>&lt;second_image&gt;</b> is a different image file.
		<li>Confirm that the new image is opened in the existing image window.
<p>
		<li>Close the image window.
		<li>Run <b>ImageViewer.exe /l &lt;second_image&gt;</b> from a command window.
		<li>Confirm that the image is opened in an image window.
	</ul>
<p>
   	<li><b>/o</b> option - Send OCR text to file
	<ul>
		<li>Run <b>ImageViewer.exe /o &lt;ocr_file.txt&gt; &lt;image_file&gt;</b> 
		from a command window.
		<li>Confirm that the image opens in ImageViewer.exe.
		<li>Use <b>Recognize text and process</b> to select some text for OCR.
		<li>Confirm that the recognized text <b>is not displayed</b> in a message box.
		<li>Confirm that the recognized text <b>is</b> stored in <b>&lt;ocr_file.txt&gt;</b>.
	</ul>
<p>
   	<li><b>/r</b> option - Register TIF extension
	<ul>
		<li>Run <b>ImageViewer.exe /r</b> from a command window.
		<li>Double-click on a <b>TIF</b> image file.
		<li>Confirm that the image <b>does</b> open in ImageViewer.exe.
	</ul>
<p>
   	<li><b>[LegacyRC #3418] /s</b> option - Search for image files
	<ul>
		<li>Run <b>ImageViewer.exe /s</b> from a command window.
		<li>Confirm that the <b>Extract Image Viewer</b> dialog appears on top of 
		an empty Image Viewer.
		<li>Browse to an image folder such as <b>C:\RedactionDemo\Images</b>.
		<li>Select a file extension such as <b>tif</b>.
		<li>Select a file name end such as <b>02</b>.
		<li>Confirm that an appropriate image opens in the Image Viewer.
		<li>Confirm that closing the search dialog closes the Image Viewer.
	</ul>
<p>
   	<li><b>[LegacyRC #5340] /script?</b> option - Display script usage
	<ul>
		<li>Run <b>ImageViewer.exe /script?</b> from a command window.
		<li>Confirm that a message box is displayed with usage information 
		for scripting.
	</ul>
<p>
   	<li><b>/u</b> option - Unregister TIF extension
	<ul>
		<li>Run <b>ImageViewer.exe /u</b> from a command window.
		<li>Double-click on a <b>TIF</b> image file.
		<li>Confirm that the image <b>does not</b> open in ImageViewer.exe.
	</ul>
<p>
   	<li><b>[LegacyRC #3667] /z</b> option - Invalid command-line argument
	<ul>
		<li>Run <b>ImageViewer.exe /z</b> from a command window.
		<li>Confirm that an <b>Invalid Argument</b> exception is displayed.
	</ul>
<p>
   	<li><b>[LegacyRC #3419] /?</b> option - Display usage
	<ul>
		<li>Run <b>ImageViewer.exe /?</b> from a command window.
		<li>Confirm that a message box is displayed with usage information.
	</ul>
<p>
   	<LI><b>[LegacyRC #5343]</b> Image Viewer and relative path
       	<ul>
      		<li>Exercise <b>"C:\Program Files\Extract 
		Systems\CommonComponents\ImageViewer.exe" 003.tif</b> from a command window in a 
		folder that contains 003.tif.
      		<li>Confirm that the image opens successfully.
      		<li>Confirm that <b>Recognize text and process</b> successfully OCRs the image.
       	</ul>
</ul>
<p>
<!-- *********************************************** -->
<li><h3>Scripting options</h3>
<ul>
   	<li><b>Test Setup</b>
	<ul>
		<li>Navigate to the
		<b>ReusableComponents\InputFunnel\InputReceivers\SpotRecognitionIR\InteractiveTest</b> 
		folder.
		<li>Confirm that various <b>Script_&lt;Description&gt;.txt</b> files are present.
		<li>Copy the first image from the RDT automated tests to
		<b>D:\Engineering\ProductDevelopment\AttributeFinder\AFCore\AutomatedTest\Images\Image1.tif</b>.  
		Without copying this file, all of the following script tests will fail.
	</ul>
<p>
   	<li><b>Test Execution</b> - Confirm that each of the following tests works as expected via 
	<b>ImageViewer.exe /e &lt;script_file&gt;</b>
	<ul>
		<li><b>[LegacyRC #3476]</b> Script_SetCurrentPageNumber_2.txt
		<li><b>[LegacyRC #3476]</b> Script_ZoomExtents.txt
		<li><b>[LegacyRC #3476]</b> Script_ZoomIn.txt
		<li><b>[LegacyRC #3476]</b> Script_ZoomOut.txt
		<li><b>[LegacyRC #3476]</b> Script_ClearImage.txt
<p>
		<li><b>[LegacyRC #3488]</b> Script_SetWindowPos_Top.txt
		<li><b>[LegacyRC #3488]</b> Script_SetWindowPos_Left.txt
		<li><b>[LegacyRC #3488]</b> Script_SetWindowPos_Bottom.txt
		<li><b>[LegacyRC #3488]</b> Script_SetWindowPos_Right.txt
		<li><b>[LegacyRC #3488]</b> Script_SetWindowPos_Full.txt
		<li><b>[LegacyRC #3488]</b> Script_SetWindowPos_Specified.txt
<p>
		<li>Script_HideButtons_OpenSavePrint.txt
		<li>Script_HideButtons_ZoomZoomInZoomOut.txt
		<li>Script_HideButtons_ZoomPreviousZoomNext.txt
		<li>Script_HideButtons_FitToPageFitToWidth.txt
		<li>Script_HideButtons_PanSelectHighlight.txt
		<li>Script_HideButtons_HighlightText.txt
		<li>Script_HideButtons_SetHighlightHeight.txt
		<li>Script_HideButtons_EditHighlightText.txt
		<li>Script_HideButtons_DeleteHighlights.txt
		<li>Script_HideButtons_RecognizeText.txt
		<li>Script_HideButtons_OpenSubImage.txt
		<li>Script_HideButtons_Rotate.txt
		<li>Script_HideButtons_PageNavigation.txt
      		<li><b>[LegacyRC #5348]</b> For each of the above <b>HideButtons</b> tests, 
		confirm proper behavior and appearance of the go to page edit box.
<p>
		<li>Script_AddTempHighlights.txt
		<li>Script_ClearTempHighlights.txt
		<li><b>[LegacyRC #3493]</b> Script_ZoomToTempHighlight.txt
		<li>Script_CenterOnTempHighlight.txt
	</ul>
</ul>
<p>
<!-- *********************************************** -->
<li><h3>Miscellaneous</h3>
<ul>
   	<li><b>[LegacyRC #3688]</b> Display page percentage in status bar.  
	<ul>
		<li>Use <b>RegEdit</b> to remove the <b>DisplayPercentageEnabled</b> key under 
                    HKEY_CURRENT_USER/Software/Extract Systems/InputFunnel/InputReceivers/SpotRecIR.</li> 
		<li>Open an image file in the Image Viewer and confirm that the rightmost 
                    two panes in the status bar display <b>X : <i>nn</i></b> and <b>Y : <i>nn</i></b> 
                    where <i>nn</i> is a numeric value that changes as the mouse moves.</li> 
		<li><b>[LegacyRC #4590]</b> Close the Image Viewer and confirm that the 
		application closes without a significant delay.</li>
		<li>Using <b>RDTConfig</b>, check the <b>Display image window percentages</b> checkbox.</li>
		<li>Open an image file and confirm that the rightmost 
                    two panes in the status bar display <b>X : <i>nn</i>, <i>pp</i>%</b> and 
                    <b>Y : <i>nn</i>, <i>pp</i>%</b> where <i>nn</i> 
                    and <i>pp</i> are numeric values that change as the mouse moves.</li> 
		<li>Close the Image Viewer.</li>
		<li>Using <b>RDTConfig</b>, uncheck the <b>Display image window percentages</b> checkbox.</li>
		<li>Open an image file and confirm that percentages are no longer displayed 
                    in the status bar.</li>
	</ul>
<p>
   	<li><b>[LegacyRC #4073]</b> Use shortcut key <b>H</b> to toggle highlighting mode.
	<ul>
		<li>Open an image file in the Image Viewer, zoom in to a portion of the 
                    image, and select <b>Pan</b> mode.</li> 
		<li>Type an <b>H</b> and confirm that the current highlighting tool is now active with 
                    the appropriate cursor.</li> 
		<li>Type another <b>H</b> and confirm that the highlighting tool toggles and the 
                    cursor also changes.</li> 
	</ul>
<p>
	<li><b>[LegacyRC #4475, #4477]</b> Highlights offset for images with small deskew angle.</li>   
	<ul>
		<li>Open <b>PoBox.rsd</b> and start the Rule Tester utility.</li> 
		<li>Open <b>Small_Deskew.tif</b> in the Rule Tester.</li> 
		<li>Execute the rules from the <b>Rule Tester</b>.</li> 
		<li>Review the two found attributes and confirm that the highlights are 
		    properly aligned with the text.</li> 
	</ul>
<p>
	<li><b>[LegacyRC #4478]</b> Highlights off image page throw an exception.</li>   
	<ul>
		<li>Open <b>OffPage.rsd</b> and start the Rule Tester utility.</li> 
		<li>Open <b>Off_Page.tif</b>  in the Rule Tester.</li> 
		<li>Execute the rules from the <b>Rule Tester</b>.</li> 
		<li>Review the found attributes and confirm that each highlight is displayed
		    without error.</li> 
	</ul>
<p>
	<li><b>[LegacyRC #4480]</b> Incorrect deskew stored for small deskew angles.</li>   
	<ul>
		<li>Open <b>Patricia.rsd</b> and start the Rule Tester utility.</li> 
		<li>Open <b>I:\Common\Engineering\ProductDevelopment\AttributeFinder\NationalRuleSet\County\Images\Document Classification\County Document\Affidavit of Death\0002.tif</b> and recognize all of the text in the image.</li> 
		<li>Execute the rules from the <b>Rule Tester</b>.</li> 
		<li>Review the found attributes and confirm that the highlights are 
		properly aligned with the text.</li> 
	</ul>
<p>
   	<LI><b>[LegacyRC #5712]</b> Confirm that a selected sub-image can be extracted and displayed 
	in a new <b>Image Viewer</b> window.
<p>
   	<li><b>[FlexIDSCore #2994]</b> Right-to-left highlighting
	<ul>
		<li>Open an image file with the Image Viewer.
		<li>Use the rectangular highlight tool to highlight some text swiping from 
		left-to-right.  Confirm that the OCR result is reasonable.
		<li>Use the rectangular highlight tool to highlight some text swiping from 
		right-to-left.  Confirm that the OCR result is reasonable.
		<li>Use the angular highlight tool to highlight some text swiping from 
		left-to-right.  Confirm that the OCR result is reasonable.
		<li>Use the angular highlight tool to highlight some text swiping from 
		right-to-left.  Confirm that the OCR result is reasonable.
	</ul>
<p>
	<li><b>[LegacyRC #4621, #4627]</b> Image Viewer does not properly handle corrupt images.
	<ul>
		<li>Save <b>(#4621) B03307AABMB.TIF (Image A)</b> and <b>(#4627) 00002.tif (Image B)</b> locally.
		<li>Right-click on <b>Image A</b> and <b>Open With Image Viewer</b>.
		<li>Verify that Image Viewer <b>displays</b> an exception showing that 
		it failed to load the file.
		<li>Verify that Image Viewer will allow you to open a non-corrupt image.
		<li>Repeat the above steps for <b>Image B</b>.
<p>
		<li>Open Image Viewer.
		<li>Open <b>Image A</b>.
		<li>Verify that Image Viewer <b>displays</b> an exception showing that
		it failed to load the file.
		<li>Verify that Image Viewer will allow you to open a non-corrupt image.
		<li>Repeat the above steps for <b>Image B</b>.
<p>
		<li>Open Image Viewer.
		<li>Open a known <b>non-corrupt</b> image.
		<li>Open <b>Image A</b>.
		<li>Verify that Image Viewer <b>displays</b> an exception showing that
		it failed to load the file.
		<li>Verify that Image Viewer will allow you to open a non-corrupt image.
		<li>Repeat the above steps for <b>Image B</b>.
	</ul>
<p>
	<li><b>[LegacyRC #4726, #5307]</b> OCR Rectangular Area.</li>   
	<ul>
		<li>Open an image in the Image Viewer.</li> 
		<li>Zoom out so that a gray area is visible both below and to the right of 
		the image.</li> 
		<li>Confirm that OCRing a rectangular region that includes text and runs off the 
		bottom of the page is successful. Note: alternatively, confirm that it is not 
		possible to select a region that runs off the page.</li> 
		<li>Confirm that OCRing a rectangular region that includes text and runs off the 
		right side of the page is successful. Note: alternatively, confirm that it is not 
		possible to select a region that runs off the page.</li> 
<p>
      		<li>Open an image in the Image Viewer.
      		<li>Select a highlight tool.
      		<li>Select <b>Recognize text and process to OCR a rectangular area</b>.
      		<li>Click on the image after the OCR results appear.
      		<li>Click OK in the OCR results.
      		<li>Confirm that the OCR results close and that no exception is logged.
	</ul>
<p>
	<li><b>[LegacyRC #4416]</b> Open image from USS.</li>   
	<ul>
		<li>From the File - Open dialog within Image Viewer, select a USS file 
		where the corresponding image file is also present in the folder.</li> 
		<li>Confirm that the image opens successfully.</li> 
	</ul>
<p>
   	<li><b>[LegacyRC #4859]</b> Problem with toolbar display.  
	<ul>
		<li>Open an image in <b>Image Viewer</b>.
		<li>Lock the workstation via <b>Ctrl+Alt+Del</b>.
		<li>Log back in to the workstation.
		<li>Confirm that the toolbar remains completely visible above the client area.
	</ul>
<p>
	<li><b>[LegacyRC #4935]</b> Up / Down scrollbar buttons do not work.</li>   
	<ul>
		<li>Open an image and zoom in so that the vertical scrollbar is active.</li> 
		<li>Scroll partway down the image.</li> 
		<li>Confirm that the <b>Up arrow</b> in the scrollbar scrolls the 
		image upward.</li> 
		<li>Confirm that the <b>Down arrow</b> in the scrollbar scrolls the 
		image downward.</li> 
	</ul>
<p>
	<li><b>[LegacyRC #5032]</b> Ignore shortcut keys during click + drag</li>   
	<ul>
		<li>Open a multi-page image.</li> 
		<li>Select one of the highlight tools.</li> 
		<li>Click and hold the mouse button while dragging the mouse in order to 
		create a highlight.</li> 
		<li>Press <b>[PageDown]</b> before releasing the mouse button.</li> 
		<li>Confirm that <b>[PageDown]</b> is ignored and the swipe can continue.
<p> 
		<li>Select the angular highlight tool.</li> 
		<li>Click and hold the mouse button while dragging the mouse in order to 
		create another highlight.</li> 
		<li>Press <b>+</b> or <b>-</b> several times before releasing the mouse button to 
		change the height of the highlight.</li> 
		<li>Confirm that the height changes during the swipe.
	</ul>
<p>
	<li><b>[FlexIDSCore #3037]</b> OCR of first page of image does not appear in .uss file</li>
	<ul>
		<li>Open this image: K:\Common\Engineering\Sample Files\OH - Montgomery 
County\Set002\probate\Backfile\RandomSubset\EST330933-1124763-20010222-I0018152.TIF</li>
		<li>OCR entire document.</li>
		<li>Confirm that the results of the OCR include the first page of the image.</li>
	</ul>
<p>
	<li><b>[LegacyRCAndUtils #5149]</b> Change Image Viewer title
	<ul>
		<li>Confirm that the name of the utility is <b>Extract Image Viewer</b>.
	</ul>
</ul>
</li>
<br />

<li><h3>Image Display in Image Viewer</h3>
<ul>
   	<li><b>[LegacyRC #3897]</b> Version 1.5 PDFs
	<ul>
		<li>Confirm that Image Viewer can open each image in the following folder.  		I:\Common\Testing\PVCS_Testing\LegacyRC\3897
	</ul>
   	<li><b>[FlexIDSCore #2693]</b> Searchable PDFs
	<ul>
		<li>Confirm that Image Viewer can open and display each image in the following folder.  		I:\Common\Testing\PVCS_Testing\FlexIDSCore\2693
	</ul>
	<li><b>[LegacyRCAndUtils #5102]</b> Unable to open PDF - Unable to initialize PDF engine</li>
	<ul>
		<li>Use <b>regedit</b> to modify the <b>GS_LIB</b> registry key, which is located under <i>HKEY_CURRENT_USER\SOFTWARE\LEAD Technologies, Inc.\Pdf</i>, to point to different folder.</li>
		<li>Confirm that the <b>Image Viewer</b> can still open PDF images.</li>
		<li>Restore the original setting for the <b>GS_LIB</b> environment variable.</li>
	</ul>
	<li><b>[LegacyRCAndUtils #4777]</b> SRW does not open a particular image.
	<ul>
		<li>Open the image attached to SCR #4745 in the Image Viewer.
		<li>Confirm that the image opens correctly.
	</ul>
</ul>
</li>
<br />

<!-- *********************************************** -->
<li><h3>Manual Rotation Testing</h3>
	<ul>
		<li>Copy all of the images in <b>I:/Common/Testing/Rotated_Images</b> to the local machine.</li>
		<li>OCR each of the images to create a .uss file.</li>
		<li><b>FOR EACH IMAGE:</b>
		<ul>
			<li>Whole Document Testing:
			<ul>
				<li>Open the image in the <b>Rule Tester</b>.  Make sure that the 
				text in the .uss file is properly OCRed.
				<ul>
					<li><b>PLEASE NOTE:</b>  Any image whose file name ends in 
					<b>VP2</b>, <b>VP5</b>, or <b>VP7</b> will NOT OCR properly 
					because it is mirrored.</li>
				</ul>
				</li>
				<li>Run <b>ExtractLines.rsd</b>, which is located in SourceGear under 
				<b>$\Engineering\ProductDevelopment\AttributeFinder\Testing\RotationTesting</b>, 
				on the image.
				<ul>
					<li>Double click on one of the found items.  This will open the 
					image in the Image Viewer.</li>
					<li>Make sure that the highlights created by the rules are in 
					the correct orientation.</li>
				</ul>
				</li>
			</ul>
			</li>
<p>
			<li>Current Page Testing:
			<ul>
				<li>While the image is still open in the Image Viewer, use the Image 
				Viewer's <b>Send text to Rule Tester window (Process Current Page)</b> 
				tool to OCR the first page of the document and send the results to the 
				Rule Tester.</li>
				<ul>
					<li>Make sure that the text that is sent to the rule tester 
					is OCRed properly.
					<ul>
						<li><b>PLEASE NOTE:</b>  Any image whose file name ends in 
						<b>VP2</b>, <b>VP5</b>, or <b>VP7</b> will NOT OCR properly 
						because it is mirrored.</li>
					</ul>
					</li>
					<li>Run <b>ExtractLines.rsd</b> again and make sure that the 
					highlights created by the rules are in the correct orientation.</li>
				</ul>
				</li>
			</ul>
			</li>
<p>
			<li>Rectangular Area Testing:
			<ul>
				<li>While the image is still open in the Image Viewer, use the Image 
				Viewer's <b>Send text to Rule Tester window (Process Rectangular Area)</b> 
				tool to OCR a rectangular region of the document and send the results to 
				the Rule Tester.</li>
				<ul>
					<li>Make sure that the text that is sent to the rule tester is 
					OCRed properly.
					<ul>
						<li><b>PLEASE NOTE:</b>  Any image whose file name ends in 
						<b>VP2</b>, <b>VP5</b>, or <b>VP7</b> will NOT OCR properly 
						because it is mirrored.</li>
					</ul>
					</li>
					<li>Run <b>ExtractLines.rsd</b> again and make sure that the 
					highlights created by the rules are in the correct orientation.</li>
				</ul>
				</li>
			</ul>
			</li>
<p>
			<li>Miscellaneous:
			<ul>
	  		   	<LI><b>[FlexIDSCore #3525]</b> Spatial String Searcher and rotated rectangles
		       		<ul>
			      		<li>Exercise the RSD file and image from 
					<b>I:\Common\Testing\PVCS_Testing\FlexIDSCore\3525</b>.
					<li>Also exercise <b>Image087_VP5.tif</b>.
					<li>Also exercise <b>Image087_VP8.tif</b>.
					<li>Also exercise <b>Image960_VP3.tif</b>.
					<li>Also exercise <b>Image23_VP7.tif</b>.
					<li>Also exercise <b>Image152_VP6.tif</b>.
	      				<li>Confirm that the rules run without error. 
			       	</ul>
			</ul>
			</li>
		</ul>
		</li>
	</ul>
</li>


<!-- *********************************************** -->
<li><h3>Automated Rotation Testing</h3>
<ul>
	<li>Make a local copy of the image files from <b>I:/Common/Testing/Rotated_Images</b>.</li> 
	<li>Using the <b>File Action Manager</b>, queue all of the images.</li>   
    <li>Configure a <b>Redact images (no verification)</b> task to run the redaction demo rules and then create an output image that contains all of the found redactions.
		<ul>
			<li>The redaction demo rules can be found in SourceGear under <b>$\Engineering\ProductDevelopment\AttributeFinder\Utils\RedactionDemo\Files\Rules</b></li>
		</ul>
	</li>
	<li>Run this task on the queued images.</li>
	<li>Confirm that each image processes without error.</li> 
	<li>Confirm that each image has an associated VOA file.</li> 
	<li>Review each output image using the <b>Windows Fax Viewer</b> and confirm the redactions are in the correct locations.</li> 
</ul>
</li>
<br />
</ol>

</body>

</html>
