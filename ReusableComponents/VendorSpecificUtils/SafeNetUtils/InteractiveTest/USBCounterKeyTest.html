<HTML>

<HEAD>
<TITLE>USB Counter Key Testing Checklist</TITLE>
<link type="text/css" rel="stylesheet" href="../../../COMComponents/UCLIDTestingFramework/Misc/UCLIDTesting.css">
</HEAD>

<BODY>

<h1>USB Counter Key Testing Checklist<BR>
<IMG src="../../../COMComponents/UCLIDTestingFramework/Misc/TestingChecklistHeader.gif">
</h1>
<hr>

<OL>

<!-- *********************************************** -->
<LI><h2>Standard operating systems: (XP, Vista, 2003 Server, 2008 Server, Windows 7)</h2>
<UL>
  	<LI>See <b>Installation</b> checklist.</LI>
</UL>
</LI>
<p>
<!-- *********************************************** -->
<LI><h2>Safenet Driver</h2>
<UL>
	<LI>Check the version information for <b>spnsrvnt.exe</b>:
	<ul>
		<li>The .\Common Files\Safenet Sentinel\ folder can be found under <b>C:\Program 
		Files</b> or <b>C:\Program Files (x86)</b>.
		<li>The EXE can be found under <b>.\Common Files\SafeNet Sentinel\Sentinel 
		Protection Server\WinNT</b>.
		<li>For the 9.0 release, confirm that the version is <b>7.5.0.5</b>.
	</ul>
</UL>
</LI>
<p>
<!-- *********************************************** -->
<LI><h2>USB License Key Manager</h2>
<UL>
	<LI>Confirm that the default License Server is <b>Local Machine</b>.
	<LI>Confirm that the <b>Counter Value For Counter Serial #</b> edit box is populated.
	<LI>Confirm that counter values are listed.
	<LI>Select <b>Remote Machine</b>, set the edit box to the name of the current machine, 
	and click Apply.
	<LI>Confirm that <b>Refresh</b> still shows the same counter values.
	<LI>Select a different Remote Machine with a key attached and Extract Systems LM or SDK 
	installed. Click Apply and confirm that <b>Refresh</b> shows a new counter serial # and 
	values for the counter on the selected machine.
	<LI>Confirm that the <b>Alert Level</b> cells are editable.
	<LI>Confirm that <b>Alert Multiple</b> cells are editable.
	<LI>Select the <b>Server Status</b> button.  This requires that the <b>Java runtime</b> be 
	installed.
	<UL>
		<LI>Confirm that a Web page is displayed with <b>Sentinel License Manager</b> 
		showing information about the key installed on the selected machine.
        	<li><b>[LegacyRC #5517]</b> Confirm that the Sentinel Protection Server Version 
		is <b>7.6.3</b>.
	</UL>
	<LI>Confirm that the <b>Send Alert to support@extractsystems.com</b> checkbox is selectable.
	<UL>
		<LI>Confirm that with no email Settings set and only this item checked 
		clicking <b> Apply</b> displays an <b>SMTP Server not set in email settings</b> error.
		<LI>Confirm that with no email Settings set and only this item checked clicking 
		<b> OK</b> displays an <b>SMTP Server not set in email settings</b> error.
	</UL>
	<LI>Confirm that the <b>If Counter Value ... following addresses:</b> checkbox is selectable.
	<UL>
		<LI>Confirm that with no email Settings set and only this item checked 
		clicking <b> Apply</b> displays an <b>SMTP Server not set in email settings</b> error.
		<LI>Confirm that with no email Settings set and only this item checked clicking 
		<b>OK</b> displays an <b>SMTP Server not set in email settings</b> error.
	</UL>
	<LI>Confirm that clicking the <b>Email Settings</b> button displays the <b>Email Settings 
	Dialog</b>.
	<h3>Email Settings Dialog</h3>
	<UL>
		<LI>Confirm that the <b>Outgoing mail (SMTP):</b> edit box is editable.
		<LI>Confirm that when blank, clicking OK displays an <b>SMTP Sever name must not 
		be blank</b> error.
		<LI>Confirm that the <b>Requires Authentication to Send</b> checkbox is selectable.					<LI>Confirm that when selected the <b>User Name</b> and <b>Password</b> edit boxes 
		are enabled.
<p>
		<LI>Confirm that the <b>Sender Display Name</b> edit box is enabled.
		<LI>Confirm that when blank, clicking OK displays a <b>Sender display name 
		must not be blank</b> error if the <b>Outgoing mail (SMTP):</b> item is set.
		<LI>Confirm that the <b>Sender Email Address</b> edit box is enabled.
		<LI>Confirm that if it is not set to a proper email address format clicking OK 
		displays a <b>Sender email address is not valid</b> error.
		<LI>Confirm that the <b>Email Signature</b> edit box is enabled.
		<LI>Confirm that <b>OK</b> saves the changes and exits the dialog.
		<LI>Confirm that <b>Cancel</b> ignores the changes and exits the dialog.
		<LI>Confirm that the <b>X</b> button ignores the changes and exits the dialog.
	</UL>
<p>
	<LI>Confirm that the <b>Address</b> edit box is enabled only when the <b>If Counter 
	value...</b> checkbox is checked.
	<LI>Confirm that when the edit box is empty and the <b>If Counter value...</b> checkbox is 
	checked then clicking Ok displays a <b>No Address list set</b> error.
</UL>
<br>
<LI><h2>Disable USB Key Via License File</h2>
<UL>
  	<LI>Create a simple RSD file without counters or internal-use flag.  Create an ID Shield 
	Rule Writing license file (using Simple Rules passwords) that allows Rule Set Editor 
	execution.  Confirm that the rules execute without an attached USB key. Note that it may 
	be necessary to edit the <b>Packages.dat</b> file in the license generator folder.</LI>
  	<LI>Use the same RSD file.  Modify the Ruleset properties to include the internal-use 
	only flag.  Confirm that the rules do not execute and that an informative exception 
	is thrown.</LI>
  	<LI>Create an additional license file that includes only <b>Disable USB Key Serial 
	Numbers</b>. Modify the RSD file properties to remove the internal-use flag.
	<LI>Confirm that the rules execute with a USB key that has a different SN than 
	the rules.</LI>
  	<LI>Modify the RSD file properties to require an <b>Indexing</b> counter.  Do NOT 
	use a USB Key.  Confirm that the rules do not execute and that an informative exception 
	is thrown.</LI>
  	<LI>Use the same modified RSD file, insert any USB key, and configure the USB License 
	Key Manager to use the local USB key.  Confirm that the rules execute.</LI>
  	<LI>Modify the RSD file to include a specified USB key serial number different than 
	the serial number of the attached key.  Confirm that the rules execute.</LI>
  	<LI>Use the same modified RSD file and delete the <b>Disable USB Key Serial Numbers</b> 
	license.  Confirm that the rules do not execute and that an informative exception 
	is thrown.</LI>
  	<LI>Create an additional license file that includes only <b>Disable USB Counters 
	(locked to PC)</b>.  Confirm that the rules execute without a USB key.</LI>
</UL></LI>
<p>
<LI><h2>Test Alert message levels</h2>
	The following test require the email settings to be configured to a valid SMTP server
	(i.e. mail.extractsystems.com) with sender display name and address with an email 
	signature set in the email settings.  The <b>If Counter value...</b> option should be 
	checked with valid email addresses in the edit box. The <b>Ruleset Editor</b> will be 
	used to create rules that will decrement the indicated counter when ran.
<p>
	The email alert received for all of the tests should have the sender <b>display name</b> 
	and sender <b>address</b> as specified in the <b>Email Settings</b> dialog.  The email 
	body should indicate which counter the alert is for with the Serial Number and remaining 
	counts.  The email should end with the text specified in the email signature in the 
	<b>Email Settings</b> dialog.
<p>
	<h2>Indexing Counter</h2>
	<UL>
		<LI>Set the <b>Alert Level</b> to value 1 less than the counter value. Run rules to 
		decrement the counter. Confirm that an email is received as specified above.
		<LI>Set the <b>Alert Level</b> to value 1 less than the counter value and the <b>Alert 
		Multiple</b> to 2. Run rules to decrement the counter 3 times. Confirm that <b>2</b> 
		emails are received as specified above.
	</UL>
	<h2>Pagination Counter</h2>
	<UL>
		<LI>Set the <b>Alert Level</b> to value 1 less than the counter value. Run rules to 
		decrement the counter. Confirm that an email is received as specified above.
		<LI>Set the <b>Alert Level</b> to value 1 less than the counter value and the <b>Alert 
		Multiple</b> to 2. Run rules to decrement the counter 3 times. Confirm that <b>2</b> 
		emails are received as specified above.
	</UL>
	<h2>Redaction Counter</h2>
	<UL>
		<LI>Set the <b>Alert Level</b> to value 1 less than the counter value. Run rules to 
		decrement the counter. Confirm that an email is received as specified above.
		<LI>Set the <b>Alert Level</b> to value 1 less than the counter value and the <b>Alert 
		Multiple</b> to 2. Run rules to decrement the counter 3 times. Confirm that <b>2</b> 
		emails are received as specified above.
	</UL>
<p>
<li><h2>Test Counter "Out of counts"</h2>
<p>
	The following test require the email settings to be configured to a valid SMTP server 
	with sender display name and address with an email signature set in the <b>Email Settings</b> 
	dialog. The <b>If Counter value...</b> option should be checked with valid email addresses 
	in the edit box. The <b>File Action Manager</b> will be used for the following tests with a 
	ruleset that decrements the appropriate counter and at least 3 files should be processed. A 
	USB counter should be setup that has <b>1</b> count for each of the counters.  For 
	information on setting count levels, see <b>Part 7</b> of this checklist.
<p>
	The email alert received for all of the tests should have the Sender Display name and sender 
	address as specified in the <b>Email Settings</b> dialog.  The email body should indicate the 
	counter the alert is for with the Serial Number and remaining counts.  The email should end 
	with the text specified in the email signature in the <b>Email Settings</b> Dialog.
<p>
	<h2>Indexing Counter</h2>
	<UL>
		<LI>Start FAM running rules on the 3 files. Confirm that on the 2nd file a dialog is 
		displayed indicating that the counter is out and the OK button should include a count 
		down of the number of seconds until a retry. 
		<LI>Click <b>Cancel</b>. Confirm that the 2nd file fails and the Counter out dialog is 
		displayed again for the 3rd file.
		<LI>Add counts to the key while the dialog is displayed. Confirm that once the counts have 
		been updated the dialog should close (after the timeout) and the 3nd file should pass.
	</UL>
	<h2>Pagination Counter</h2>
	<UL>
		<LI>Start FAM running rules on the 3 files. Confirm that on the 2nd file a dialog is 
		displayed indicating that the counter is out and the OK button should include a count 
		down of the number of seconds until a retry. 
		<LI>Click <b>Cancel</b>. Confirm that the 2nd file fails and the Counter out dialog is 
		displayed again for the 3rd file.
		<LI>Add counts to the key while the dialog is displayed. Confirm that once the counts have 
		been updated the dialog should close (after the timeout) and the 3nd file should pass.
	</UL>
	<h2>Redaction Counter</h2>
	<UL>
		<LI>Start FAM running rules on the 3 files. Confirm that on the 2nd file a dialog is 
		displayed indicating that the counter is out and the OK button should include a count 
		down of the number of seconds until a retry. 
		<LI>Click <b>Cancel</b>. Confirm that the 2nd file fails and the Counter out dialog is 
		displayed again for the 3rd file.
		<LI>Add counts to the key while the dialog is displayed. Confirm that once the counts have 
		been updated the dialog should close (after the timeout) and the 3nd file should pass.
	</UL>
<p>
<li><h2>Add increments to Counter - Should be repeated for each Counter type</h2>
	<h2>Indexing Counter</h2>
	Note: Sentinel Key Manager is located at 
	<b>I:\Common\Engineering\Tools\SecureClients\USBKey\USBKeyManager</b>.
	<UL>
		<LI>Open the <b>Field Activation Utility</b> with USB Key attached.
		<LI>Click <b>Get Locking Code</b> and copy the code to a file.
		<LI>Use <b>Sentinel Key Manager</b> with the Distributor's Key.
		<LI>If DST file has not been imported - Import the DST file named <b>KeyManager.dst</b>.
		<LI>Load the saved file on the <b>Key Activator</b> tab.
		<LI>Select <b>IncIndexing...</b> 
		<LI>Generate License Code
		<LI>Save License Code to File
<p>
		<LI>With <b>Field Activation Utility</b>
		<UL>
			<LI>Load License Code
			<LI>Click <b>Update License</b>. 
			<li>Confirm that a <b>success</b> message is seen.
		</UL>
		<LI>With <b>USB License Key Manager</b>
		<UL>
			<LI>Click Refresh.
			<li>Confirm that the amount of the increase is added to the counter.
		</UL>
	</UL>
	<h2>Pagination Counter</h2>
	<UL>
		<LI>Open the <b>Field Activation Utility</b> with USB Key attached.
		<LI>Click <b>Get Locking Code</b> and copy the code to a file.
		<LI>Use <b>Sentinel Key Manager</b> with the Distributor's Key.
		<LI>If DST file has not been imported - Import the DST file named <b>KeyManager.dst</b>.
		<LI>Load the saved file on the <b>Key Activator</b> tab.
		<LI>Select <b>IncPagination...</b> 
		<LI>Generate License Code.
		<LI>Save License Code to File.
<p>
		<LI>With <b>Field Activation Utility</b>
		<UL>
			<LI>Load License Code
			<LI>Click <b>Update License</b>. 
			<li>Confirm that a <b>success</b> message is seen.
		</UL>
		<LI>With <b>USB License Key Manager</b>
		<UL>
			<LI>Click Refresh.
			<li>Confirm that the amount of the increase is added to the counter.
		</UL>
	</UL>
	<h2>Redaction Counter</h2>
	<UL>
		<LI>Open the <b>Field Activation Utility</b> with USB Key attached.
		<LI>Click <b>Get Locking Code</b> and copy the code to a file.
		<LI>Use <b>Sentinel Key Manager</b> with the Distributor's Key.
		<LI>If DST file has not been imported - Import the DST file named <b>KeyManager.dst</b>.
		<LI>Load the saved file on the <b>Key Activator</b> tab.
		<LI>Select <b>IncRedaction...</b> 
		<LI>Generate License Code.
		<LI>Save License Code to File.
<p>
		<LI>With <b>Field Activation Utility</b>
		<UL>
			<LI>Load License Code
			<LI>Click <b>Update License</b>. 
			<li>Confirm that a <b>success</b> message is seen.
		</UL>
		<LI>With <b>USB License Key Manager</b>
		<UL>
			<LI>Click Refresh.
			<li>Confirm that the amount of the increase is added to the counter.
		</UL>
	</UL>
<p>
<LI><h2>Counter Management</h2>
<ul>
	<li><u>Goals</u>
	<ul>
		<li>Ensure that <b>Application trace</b> items are logged 
		for each transition across <b>1000</b> counts.
		<li>Accumulate USB decrement requests to limit the number 
		of counter requests and allow for more processors to 
		successfully access a multi-user key.
	</ul>
<p>
	<li><u>Logged transitions</u>
	<ul>
		<li>Ensure that <b>Application trace</b> items are logged 
		for each transition across <b>1000</b> counts. (Note: Only 
		one trace message will be logged if a very large image is 
		processed that might otherwise require multiple log 
		entries.)
		<ul>
			<li>Test this with a local, single-user key.
			<li>Test this with a remote, multiple-user key.
		</ul>
	</ul>
<p>
	<li><u>Accumulate decrement requests</u>
	<ul>
		<li>Prepare a large number of single-page images to be 
		processed with an <b>ID Shield</b> ruleset that requires a 
		decrement-by-page USB key.
		<li>Prepare an FPS file to process the files using only one 
		or two threads in order to more carefully watch decrements 
		of the USB counter.
		<li>Use a local USB key to minimize delay in counter value 
		refreshes.
		<li>Process the files and refresh the <b>USB License Key 
		Manager</b> frequently, noting the number of counts removed 
		with each refresh.
		<ul>
			<li>Confirm that beginning processing still decrements 
			the counter by single pages.
			<li>Confirm that counter decrements increase up to a 
			maximum of <b>10</b> pages at a time.
		</ul>
		<li>Confirm that killing a FAM instance provides a small 
		number of free counts since the accumulated decrement is not 
		applied to the key.
		<li>Confirm that the usual retry code is still executed and 
		works properly if the USB key is missing.
		<li>Confirm that for a USB key with few remaining counts, the 
		decrement is not greater than 1% of the remaining counts.
		<li>Confirm that for a USB key with <b>less than 100</b> 
		remaining counts, the decrement remains at <b>1</b>.
		<li>Confirm that the counter value will not go negative.
	</ul>
</ul>
<p>
<LI><h2>Error Handling</h2>
<ul>
	<li>Test Setup for next numbered items
	<UL>
  		<LI>Prepare a set of local images to use with the File Action Manager where the 
		specified rules require a USB counter.
		<LI>Confirm that FLEX Index / ID Shield is configured to use a local USB key.
		<LI>Start processing and confirm that some files are processed successfully.
		<LI>If desired, change the <b>NumberOfUSBKeyRetries</b> and 
		<b>WaitTimeoutUSBKeyRetry</b> registry settings at 
		<b>HKLM\SOFTWARE\Extract Systems\SafeNetUtils</b>.
	</UL>
	</li>
<p>
	<li>(ONE) Removal of USB Key from port
	<UL>
  		<LI>During processing, remove the local USB key.
		<LI>Confirm that the file or files being processed <b>do not</b> immediately fail.
  		<LI>Replace the USB key within the time defined in the registry and confirm that 
		the currently processing files finish without failure.
  		<LI>Remove the USB key again and keep it removed for more than the time defined 
		in the registry.
  		<LI>Confirm that the first of the currently processing files fail after the time 
		defined in the registry and newly processing files fail after the same wait.
  		<LI>Replace the USB key and confirm that the currently processing files finish 
		without failure.
	</UL>
	</li>
<p>
	<li>(TWO) Stop and restart of Sentinel service
	<UL>
  		<LI>Open the <b>Administrative Tools - Services</b> element of the <b>Windows 
		Control Panel</b>.
  		<LI>Find the <b>Sentinel Protection Server</b> item and <b>Stop</b> the service.
		<LI>Confirm that the file or files being processed <b>do not</b> immediately fail.
  		<LI>Start the service within the time defined in the registry and confirm that 
		the currently processing files finish without failure.
  		<LI>Stop the service again and keep it stopped for more than the time defined 
		in the registry.
  		<LI>Confirm that the first of the currently processing files fail after the 
		time defined in the registry and newly processing files fail after the same wait.
  		<LI><b>Start</b> the service and confirm that the currently processing files 
		finish without failure.
	</UL>
	</li>
<p>
	<li>(THREE) Locked USB key
	<UL>
  		<LI>Use the USB Key Tester utility under <b>I:\Common\Engineering\Tools\Utils</b> 
		to lock the USB key (Note that this utility does not exist yet).
		<LI>Confirm that the file or files being processed <b>do not</b> immediately fail.
		<LI>Confirm that the USB key is automatically unlocked within about 2 minutes and 
		that the currently processing files finish successfully.
  		<LI>Lock the key again and then remove it from the system.
  		<LI>Confirm that the currently processing files fail after about 20 minutes and 
		newly processing files fail after the same 20 minute wait.
  		<LI>Replace the key and confirm that the currently processing files finish 
		without failure.
	</UL>
	</li>
<p>
	<li>(FOUR) Disruption of network connection
	<UL>
  		<LI>Modify the configuration to use a network USB key (usually on LISA).
  		<LI>During processing, unplug the network cable to simulate a disrupted network 
		connection.
		<LI>Confirm that the file or files being processed <b>do not</b> immediately fail.
  		<LI>Replace the network connection within the time defined in the registry and 
		confirm that the currently processing files finish without failure.
  		<LI>Remove the network connection again and keep it removed for more than the 
		time defined in the registry.
  		<LI>Confirm that the first of the currently processing files fail after the 
		time defined in the registry and newly processing files fail after the same wait.
  		<LI>Replace the network connection and confirm that the currently processing files 
		finish without failure.
	</UL>
	</li>
</UL>
<p>
<LI><h2>Support for AnywhereUSB Device</h2>
<UL>
	<li><b>Setup</b>
	<ul>
	  	<LI>Confirm that the hardware has power and is connected to an ethernet port.
		<li>Run <b>I:\Common\Engineering\Tools\Utils\AnywhereUSB\AWSplash.exe</b> to install the 
		appropriate drivers on the test machine.
		<li>Run <b>AnywhereUSB Concentrator Configuration Utility</b> from the Start menu 
		to assign an IP address
		<ul>
			<li>Click the <b>Configure</b> button.
			<ul>
				<li>Provide a device name such as <b>USBAnywhere</b>.
				<li>Click the <b>Enable</b> button in the DHCP group box.
				<li>Click the <b>Update</b> button.
				<li>Click the <b>Close</b> button.
			</ul>
			<li>Click the <b>Connect</b> button.
		</ul>
	</ul>
<p>
	<li><b>Basic Functionality</b>
	<ul>
		<li>Attach a USB key to the <b>AnywhereUSB</b> device.
		<li>Use the <b>USB License Key Manager</b> utility to confirm that the USB key 
		is visible as a <b>local</b> device.
		<li>Confirm that rules will run and properly decrement each USB counter
		<ul>
			<li>Indexing
			<li>Pagination
			<li>Redaction
		</ul>
		<li>Confirm that drivers can be installed on a virtual machine allowing access to 
		the <b>(local)</b> USB key.
		<li>Install <b>Extract Systems LM</b> and confirm that the <b>Field Activation Utility</b> 
		can successfully update each counter value
		<ul>
			<li>Indexing
			<li>Pagination
			<li>Redaction
		</ul>
	</ul>
<p>
	<li><b>Complex Functionality</b>
	<ul>
		<li>Physically connect a USB key to another test machine.
		<li>Confirm that the USB key is available via remote connection.
		<li>Install the AnywhereUSB drivers on the test machine currently hosting the USB key.
		<li>Configure the AnywhereUSB device to use this test machine.
		<li>Confirm that the USB key is still available via remote connection.
<p>
		<li>Adjust the <b>NumberOfUSBKeyRetries</b> and <b>WaitTimeoutUSBKeyRetry</b> 
		keys under <b>HKLM\Software\Extract Systems\SafeNetUtils</b> to make 
		the following tests more manageable.
		<li>Confirm that FLEX Index and ID Shield recover gracefully from the removal and later 
		replacement of the USB key.
		<li>Confirm that FLEX Index and ID Shield recover gracefully from the stop and later 
		restart of the <b>Sentinel Protection Server</b> service.
	</ul>
</UL>
</LI>
</body>
</HTML>
