<HTML>

<HEAD>
<TITLE>USB Counter Key Testing Checklist</TITLE>
<link type="text/css" rel="stylesheet" href="../../../COMComponents/UCLIDTestingFramework/Misc/UCLIDTesting.css">
</HEAD>

<BODY>

<h1>USB Counter Key Testing Checklist<BR>
<IMG src="../../../COMComponents/UCLIDTestingFramework/Misc/TestingChecklistHeader.gif">
</h1>
<hr>

<OL>

<!-- *********************************************** -->
<LI><h3>Safenet Driver</h3>
<UL>
	<LI>Check the version information for <b>spnsrvnt.exe</b>:
	<ul>
		<li>The .\Common Files\Safenet Sentinel\ folder can be found under <b>C:\Program 
		Files</b> or <b>C:\Program Files (x86)</b>.
		<li>The EXE can be found under <b>.\Common Files\SafeNet Sentinel\Sentinel 
		Protection Server\WinNT</b>.
		<li>For the 9.0 release, confirm that the version is <b>7.6.0.7</b>.
	</ul>
</UL>
</LI>
<p>
<!-- *********************************************** -->
<LI><h3>USB License Key Manager</h3>
<UL>
	<LI>Confirm that the default License Server is <b>Local Machine</b>.
	<LI>Confirm that the <b>Max # of configurable licenses for key</b> edit box is populated.
	<LI>Confirm that the <b># of configured licenses</b> edit box is populated.
	<LI>Confirm that the <b>Counter Value For Counter Serial #</b> edit box is populated.
	<LI>Confirm that counter values are listed.
	<ul>
		<li>FLEX Index - Indexing
		<li>FLEX Index - Pagination
		<li>ID Shield - Redaction
	</ul>
	<LI>Select <b>Remote Machine</b>, set the edit box to the name of the current machine, 
	and click Apply.
	<LI>Confirm that <b>Refresh</b> still shows the same counter values.
	<LI>Select a different Remote Machine with a key attached and Extract Systems LM or SDK 
	installed. Click Apply and confirm that <b>Refresh</b> shows a new counter serial # and 
	values for the counter on the selected machine.
	<LI>Confirm that the <b>Alert Level</b> cells are editable.
	<LI>Confirm that <b>Alert Multiple</b> cells are editable.
	<LI>Select the <b>Server Status</b> button.  This requires that the <b>Java runtime</b> be 
	installed.
	<UL>
		<LI>Confirm that a Web page is displayed with <b>Sentinel License Manager</b> 
		showing information about the key installed on the selected machine.
        	<li><b>[LegacyRC #5517]</b> Confirm that the Sentinel Protection Server Version 
		is <b>7.6.0</b>.
	</UL>
	<LI>Confirm that clicking the <b>Email Settings</b> button displays the <b>Email Settings 
	Dialog</b>.
	<h2>Email Settings Dialog</h2>
	<UL>
		<LI>Confirm that the <b>Outgoing mail (SMTP):</b> edit box is editable.
		<LI>Confirm that the <b>Requires Authentication to Send</b> checkbox is selectable.					<LI>Confirm that when selected the <b>User Name</b> and <b>Password</b> edit boxes 
		are enabled.
		<LI>Confirm that when selected the <b>Use SSL</b> check box is also enabled.
		<LI>Confirm that the <b>Sender Display Name</b> edit box is enabled.
		<LI>Confirm that the <b>Sender Email Address</b> edit box is enabled.
		<LI>Confirm that if it is not set to a proper email address format clicking <b>OK</b> 
		displays a <b>Possible invalid email</b> error.
		<LI>Confirm that the <b>Email Signature</b> edit box is enabled.
<p>
		<LI>Confirm that the <b>OK</b> button is disabled if one or more of the following 
		settings is blank.
		<ul>
			<li>Outgoing mail (SMTP) server:
			<li>Sender display name:
			<li>Sender email address:
		</ul>
		<LI>Confirm that the <b>OK</b> button is also disabled if the <b>Requires 
		authentication to send</b> checkbox is checked and the <b>User name</b> is 
		undefined.
<p>
		<LI>Confirm that <b>OK</b> saves the changes and exits the dialog.
		<LI>Confirm that <b>Cancel</b> ignores the changes and exits the dialog.
		<LI>Confirm that the <b>X</b> button ignores the changes and exits the dialog.
	</UL>
<p>
	<LI>Confirm that the <b>Send Alert to support@extractsystems.com</b> checkbox is selectable.
	<LI>Confirm that the <b>If Counter Value ... following addresses:</b> checkbox is selectable.
	<LI>Confirm that the <b>Address</b> edit box is enabled only when the <b>If Counter 
	value...</b> checkbox is checked.
	<LI>Confirm that when the edit box is empty and the <b>If Counter value...</b> checkbox is 
	checked then clicking Ok displays a <b>No Address list set</b> error.
</UL>
<br>
<li><h3>Set and Add increments to Counter</h3>
	<h2>Setup</h2>
	<UL>
		<LI>The Sentinel Key Manager utility is located at 
		<b>I:\Common\Engineering\Tools\SecureClients\USBKey\NewUSBKeyManagerWithSet</b>.
		<li>Insert the <b>Distributor Key</b> USB key.  This key is generally controlled 
		by Mike or someone else in <b>Support</b>.
		<li>Open <b>KeyManager.exe</b>.
		<li>Click the <b>Import DST File...</b> button and import the <b>KeyManager.dst</b> 
		file if it has not previously been imported on the test machine.
		<li>Confirm that <b>ExtractSystems</b> is selected in the corresponding combo box.
		<li>Confirm that <b>FlexIndex</b> is selected in the corresponding list box.
		<li>Click on the <b>Key Activator</b> tab.
	</UL>
	<h2>Process</h2>
	<UL>
		<LI>Click the <b>Get Locking Code</b> button in the <b>File Activation Utility</b>.
		<LI>Copy the locking code to the Clipboard or to a file.
		<li>Paste the locking code into the appropriate edit box on the <b>Key Activator</b> 
		tab of the <b>Sentinel Key Manager</b> utility.
		<li>Select one or more actions to be performed on the test USB key.
		<ul>
			<li>To set counts, multiple counts can be set in a single operation.
			<li>To increment counts, only one counter can be incremented per 
			operation.
		</ul>
		<li>Click the <b>Generate License Code &gt;&gt;</b> button.
		<li>Set the desired counter values or increments and click <b>OK</b>.
		<li>Copy the resulting license string to the Clipboard or to a file.
		<LI>Paste the license string into the <b>Update License</b> edit box in the 
		<b>File Activation Utility</b>.
		<li>Click the <b>Update License</b> button in the <b>File Activation 
		Utility</b> to update the testing key.
		<li>Use the <b>USB License Key Manager</b> utility to confirm the result.
	</UL>
<p>
	<h2>Test Cases</h2>
	<UL>
		<LI>Exercise <b>SetFlexUserCount</b> on a multiple-user key.  Confirm that 
		the number of allowed users can be set properly.
		<LI>Clear all counters on the key by setting each counter to <b>0</b>.
		<ul>
			<li><b>SetRedactionCounter</b>
			<li><b>SetFlexIndexCounter</b>
			<li><b>SetPaginationCounter</b>
		</ul>
		<li>Exercise <b>SetRedactionCounter</b> to set a specified value for the 
		Redaction counter.
		<li>Exercise <b>SetFlexIndexCounter</b> to set a specified value for the 
		Indexing counter.
		<li>Exercise <b>SetPaginationCounter</b> to set a specified value for the 
		Pagination counter.
		<li>Exercise <b>IncRedactionCounter</b> to add a small number of counts to 
		the Redaction counter.
		<li>Exercise <b>IncFlexIndexCounter</b> to add a small number of counts to 
		the Indexing counter.
		<li>Exercise <b>IncPaginationCounter</b> to add a small number of counts to 
		the Pagination counter.
<p>
		<li>Return the <b>Distributor Key</b> to <b>Support</b>.
	</UL>
<p>
<LI><h3>Test Counter Alerts</h3>
	<h2>Setup</h2>
	<UL>
		<LI>Configure email settings with a valid SMTP server such as mail.extractsystems.com.
		<li>Provide a sender display name and address plus an email signature.
		<li>Select the <b>If Counter value...</b> checkbox and provide a valid email address 
		in the edit box.
		<li>Check the <b>Send Alert to...</b> checkbox for <u>one</u> of the test cases below.  
		Confirm with <b>Support</b> that an appropriate email was received.
		<li>Prepare a ruleset to be exercised with the <b>Rule Tester</b> utility.  The 
		required counter will be modified as appropriate for each test.
	</UL>
	<h2>Process</h2>
	<UL>
		<LI>Set the appropriate <b>Alert Level</b> to a value 1 less than the current counter 
		value. 
		<LI>Set the <b>Alert Multiple</b> to 2. 
		<li>Exercise the rules to decrement the counter. Confirm that an email is received 
		as specified above.
		<ul>
			<li>Confirm proper sender name and sender address.
			<li>Confirm proper signature.
			<li>Confirm proper counter name, serial number and remaining counts.
		</ul>
		<li>Exercise the rules two more times. Confirm that <b>1</b> additional email is 
		received as specified above.
	</UL>
<p>
	<h2>Test Cases</h2>
	<UL>
		<li>Exercise the <b>FLEX Index - Indexing</b> counter.
		<li>Exercise the <b>FLEX Index - Pagination</b> counter.
		<li>Exercise the <b>ID Shield - Redaction</b> counter.
	</UL>
<p>
<li><h3>Test Counter "Out of counts"</h3>
<p>
	<h2>Setup</h2>
	<UL>
		<LI>Configure email settings as above.
		<li>Adjust the counts available on the local USB key to be nearly exhausted.
		<li>Prepare a ruleset to be exercised with the <b>File Action Manager</b>.  The 
		required counter will be modified as appropriate for each test.
		<li>Prepare a set of sample images such that more images will be processed than 
		are available with the counter.
	</UL>
	<h2>Process</h2>
	<UL>
		<li>Confirm that the ruleset decrements the desired counter.
		<LI>Exercise the rules in the FAM. 
		<LI>Confirm that the appropriate number of files process successfully.
		<li>Confirm that a countdown dialog appears prompting the user to add more counts.
		<li>Confirm that the countdown dialog closes and immediately reopens if counts 
		are not added to the counter.
		<li>Confirm that clicking the <b>Cancel</b> button on the countdown dialog 
		causes one processing file to fail.
		<li>Confirm that another countdown dialog appears.
		<li>Add counts to the counter.
		<li>Confirm that processing continues successfully.
	</UL>
<p>
	<h2>Test Cases</h2>
	<UL>
		<li>Exercise the <b>FLEX Index - Indexing</b> counter.
		<li>Exercise the <b>FLEX Index - Pagination</b> counter.
		<li>Exercise the <b>ID Shield - Redaction</b> counter.
	</UL>
<p>
<LI><h3>Counter Management</h3>
<ul>
	<li><u>Goals</u>
	<ul>
		<li>Ensure that <b>Application trace</b> items are logged 
		for each transition across <b>1000</b> counts.
		<li>Accumulate USB decrement requests to limit the number 
		of counter requests and allow for more processors to 
		successfully access a multi-user key.
	</ul>
<p>
	<li><u>Logged transitions</u>
	<ul>
		<li>Ensure that <b>Application trace</b> items are logged 
		for each transition across <b>1000</b> counts. (Note: Only 
		one trace message will be logged if a very large image is 
		processed that might otherwise require multiple log 
		entries.)
		<ul>
			<li>Test this with a local, single-user key.
			<li>Test this with a remote, multiple-user key.
		</ul>
	</ul>
<p>
	<li><u>Accumulate decrement requests</u>
	<ul>
		<li>Prepare a large number of single-page images to be 
		processed with an <b>ID Shield</b> ruleset that requires a 
		decrement-by-page USB key.
		<li>Prepare an FPS file to process the files using only one 
		or two threads in order to more carefully watch decrements 
		of the USB counter.
		<li>Use a local USB key to minimize delay in counter value 
		refreshes.
		<li>Process the files and refresh the <b>USB License Key 
		Manager</b> frequently, noting the number of counts removed 
		with each refresh.
		<ul>
			<li>Confirm that beginning processing still decrements 
			the counter by single pages.
			<li>Confirm that counter decrements increase up to a 
			maximum of <b>10</b> pages at a time.
		</ul>
		<li>Confirm that killing a FAM instance provides a small 
		number of free counts since the accumulated decrement is not 
		applied to the key.
		<li>Confirm that the usual retry code is still executed and 
		works properly if the USB key is missing.
		<li>Confirm that for a USB key with few remaining counts, the 
		decrement is not greater than 1% of the remaining counts.
		<li>Confirm that for a USB key with <b>less than 100</b> 
		remaining counts, the decrement remains at <b>1</b>.
		<li>Confirm that the counter value will not go negative.
	</ul>
</ul>
<p>
<LI><h3>Error Handling</h3>
<ul>
	<li>Test Setup for next numbered items
	<UL>
  		<LI>Prepare a set of images to use with the FAM where the specified rules 
		require a local USB counter.
		<LI>If desired, change the <b>NumberOfUSBKeyRetries</b> and 
		<b>WaitTimeoutUSBKeyRetry</b> registry settings at 
		<b>HKLM\SOFTWARE\Extract Systems\SafeNetUtils</b>.
		<LI>Start processing and confirm that some files are processed successfully.
	</UL>
	</li>
<p>
	<li>(ONE) Removal of USB Key from port
	<UL>
  		<LI>During processing, remove the local USB key.
		<LI>Confirm that the file or files being processed <b>do not</b> immediately fail.
  		<LI>Replace the USB key and confirm that the currently processing files finish 
		without failure.
	</UL>
	</li>
<p>
	<li>(TWO) Stop and restart of Sentinel service
	<UL>
  		<LI>Open the <b>Administrative Tools - Services</b> element of the <b>Windows 
		Control Panel</b>.
  		<LI>Find the <b>Sentinel Protection Server</b> item and <b>Stop</b> the service.
		<LI>Confirm that the file or files being processed <b>do not</b> immediately fail.
  		<LI>Start the service within the time defined in the registry and confirm that 
		the currently processing files finish without failure.
  		<LI>Stop the service again and keep it stopped for more than the time defined 
		in the registry.
  		<LI>Confirm that the first of the currently processing files fail after the 
		time defined in the registry and newly processing files fail after the same wait.
  		<LI><b>Start</b> the service and confirm that the currently processing files 
		finish without failure.
	</UL>
	</li>
<p>
	<li>(THREE) Disruption of network connection
	<UL>
  		<LI>Modify the configuration to use a network USB key (usually on LISA).
  		<LI>During processing, unplug the network cable to simulate a disrupted network 
		connection.
		<LI>Confirm that the file or files being processed <b>do not</b> immediately fail.
  		<LI>Replace the network connection within the time defined in the registry and 
		confirm that the currently processing files finish without failure.
  		<LI>Remove the network connection again and keep it removed for more than the 
		time defined in the registry.
  		<LI>Confirm that the first of the currently processing files fail after the 
		time defined in the registry and newly processing files fail after the same wait.
  		<LI>Replace the network connection and confirm that the currently processing files 
		finish without failure.
	</UL>
	</li>
</UL>
<p>
<LI><h3>Disable USB Key Via License File</h3>
<UL>
  	<LI>Create a simple RSD file without counters or internal-use flag.  Create an ID Shield 
	Rule Writing license file (using Simple Rules passwords) that allows Rule Set Editor 
	execution.  Confirm that the rules <b>do not</b> execute without an attached USB key.</LI>
  	<LI>Use the same RSD file.  Modify the Ruleset properties to include the internal-use 
	only flag.  Confirm that the rules <b>do</b> execute.</LI>
  	<LI>Create an additional license file that includes only <b>Disable USB Key Serial 
	Numbers</b>. Modify the RSD file properties to remove the internal-use flag.
	<LI>Confirm that the rules execute with a USB key that has a different SN than 
	the rules.</LI>
  	<LI>Modify the RSD file properties to require an <b>Indexing</b> counter.  Do NOT 
	use a USB Key.  Confirm that the rules do not execute and that an informative exception 
	is thrown.</LI>
  	<LI>Use the same modified RSD file, insert any USB key, and configure the USB License 
	Key Manager to use the local USB key.  Confirm that the rules execute.</LI>
  	<LI>Modify the RSD file to include a specified USB key serial number different than 
	the serial number of the attached key.  Confirm that the rules execute.</LI>
  	<LI>Use the same modified RSD file and delete the <b>Disable USB Key Serial Numbers</b> 
	license.  Confirm that the rules do not execute and that an informative exception 
	is thrown.</LI>
  	<LI>Create an additional license file that includes only <b>Disable USB Counters 
	(locked to PC)</b>.  Confirm that the rules execute without a USB key.</LI>
</UL></LI>
<p>
<LI><h3>Support for AnywhereUSB Device</h3>
<UL>
	<li><b>Setup</b>
	<ul>
	  	<LI>Confirm that the hardware has power and is connected to an ethernet port.
		<li>Run <b>I:\Common\Engineering\Tools\Utils\AnywhereUSB\AWSplash.exe</b> to install the 
		appropriate drivers on the test machine.
		<li>Run <b>AnywhereUSB Concentrator Configuration Utility</b> from the Start menu 
		to assign an IP address
		<ul>
			<li>Click the <b>Configure</b> button.
			<ul>
				<li>Provide a device name such as <b>USBAnywhere</b>.
				<li>Click the <b>Enable</b> button in the DHCP group box.
				<li>Click the <b>Update</b> button.
				<li>Click the <b>Close</b> button.
			</ul>
			<li>Click the <b>Connect</b> button.
		</ul>
	</ul>
<p>
	<li><b>Basic Functionality</b>
	<ul>
		<li>Attach a USB key to the <b>AnywhereUSB</b> device.
		<li>Use the <b>USB License Key Manager</b> utility to confirm that the USB key 
		is visible as a <b>local</b> device.
		<li>Confirm that rules will run and properly decrement each USB counter
		<ul>
			<li>Indexing
			<li>Pagination
			<li>Redaction
		</ul>
		<li>Confirm that drivers can be installed on a virtual machine allowing access to 
		the <b>(local)</b> USB key.
		<li>Install <b>Extract Systems LM</b> and confirm that the <b>Field Activation Utility</b> 
		can successfully update each counter value
		<ul>
			<li>Indexing
			<li>Pagination
			<li>Redaction
		</ul>
	</ul>
<p>
	<li><b>Complex Functionality</b>
	<ul>
		<li>Physically connect a USB key to another test machine.
		<li>Confirm that the USB key is available via remote connection.
		<li>Install the AnywhereUSB drivers on the test machine currently hosting the USB key.
		<li>Configure the AnywhereUSB device to use this test machine.
		<li>Confirm that the USB key is still available via remote connection.
<p>
		<li>Adjust the <b>NumberOfUSBKeyRetries</b> and <b>WaitTimeoutUSBKeyRetry</b> 
		keys under <b>HKLM\Software\Extract Systems\SafeNetUtils</b> to make 
		the following tests more manageable.
		<li>Confirm that FLEX Index and ID Shield recover gracefully from the removal and later 
		replacement of the USB key.
		<li>Confirm that FLEX Index and ID Shield recover gracefully from the stop and later 
		restart of the <b>Sentinel Protection Server</b> service.
	</ul>
</UL>
</LI>
</body>
</HTML>
